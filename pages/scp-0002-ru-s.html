<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html">
  <meta name="description" content="Compilation of extracted CSS styles on the SCP Wiki">
  <meta name="keywords" content="scp,wiki,styles,wikidot">
  <meta name="author" content="SCP Wiki">
  <meta name="generator" content="wikidot-css-extractor">

  <script src="https://tristen.ca/tablesort/dist/tablesort.min.js"></script>
<script src="https://tristen.ca/tablesort/dist/sorts/tablesort.number.min.js"></script>
<script src="https://emmiegit.github.io/wikidot-css-extractor/static/script.js" async></script>
  <link rel="stylesheet" href="https://tristen.ca/tablesort/tablesort.css">
<link rel="stylesheet" href="https://emmiegit.github.io/wikidot-css-extractor/static/style.css">

  <title>SCP-0002-RU-S - Практические занятия</title>
</head>
<body>
<div id="container">
  
  <div class="page">
    <h1 class="title">SCP-0002-RU-S - Практические занятия</h1>
    <p>
      Link to article: <a href="https://scp-wiki.wikidot.com/scp-0002-ru-s" target="_blank">SCP-0002-RU-S - Практические занятия</a>.
    </p>

    <h2 class="header">Module Styles</h2>
    <ul class="module-styles">
      
        <li>
          (none)
        </li>
      
    </ul>

    <h2 class="header">Inline Styles</h2>
    <ul class="inline-styles">
      
        <li>
          <pre><code>margin: 0 10px;</code></pre>
        </li>
      
        <li>
          <pre><code>padding: 10px; border: 1px none silver; width: 72%;</code></pre>
        </li>
      
        <li>
          <pre><code>padding: 10px;  border: 1px none silver; width: 27%;</code></pre>
        </li>
      
        <li>
          <pre><code>text-align:center</code></pre>
        </li>
      
    </ul>

    <h2 class="header">Includes</h2>
    <ul class="includes">
      
        <li>(none)</li>
      
    </ul>

    <h2 class="header">CSS Classes</h2>
    <ul class="css-classes">
      
        <li>
          <pre><code>wiki-content-table</code></pre>
        </li>
      
        <li>
          <pre><code>wiki-content-table</code></pre>
        </li>
      
        <li>
          <pre><code>image</code></pre>
        </li>
      
        <li>
          <pre><code>image</code></pre>
        </li>
      
        <li>
          <pre><code>wiki-content-table</code></pre>
        </li>
      
    </ul>

    <h2 class="header">Page Source</h2>
    <pre><textarea class="page-source" readonly>[[&gt;]]
[[module Rate]]
[[/&gt;]]
[[&gt;]]

[[table style=&#34;margin: 0 10px;&#34;]]
[[row]]
[[cell  style=&#34;padding: 10px; border: 1px none silver; width: 72%;&#34;]]
[[/cell]]
[[cell style=&#34;padding: 10px;  border: 1px none silver; width: 27%;&#34;]]

[[size larger]]**ДЛЯ СЛУЖЕБНОГО ПОЛЬЗОВАНИЯ**[[/size]]

                   **ФОНД SCP: РОССИЙСКИЙ ФИЛИАЛ ОРГАНИЗАЦИИ**  
                           **РЕДАКЦИЯ №1 ОТ 26.05.2015**
                   [[size small]]**УЧТЁННЫЙ ЭКЗЕМПЛЯР**[[/size]]


[[/cell]]
[[/row]]
[[row]]
[[cell  style=&#34;text-align:center&#34;]]
[!--  [[size larger]]**РАПОРТ SCP-0002-RU-S**[[/size]] --]
[[/cell]]
[[/row]]
[[/table]]

[[/&gt;]]




[[module ListUsers users=&#34;.&#34;]]
В данном рапорте представлен отчёт о действиях стажёра мобильной оперативной группы МОГ-11 &#34;Боевые коты&#34; кадета **Лисицына**, прибывшего для проведения практических занятий по сдаче нормативов, необходимых для присвоения ему должности полевого агента Организации.

Заседание аттестационной комиссии проходило в здании Комплекса нестандартных испытаний Зоны 7██ [ДАТА И ВРЕМЯ УДАЛЕНЫ], в день, когда доктор **%%title%%** прибыл в Зону для проведения запланированной [[[http://scpfoundation.ru/scp-0001-ru-s| лабораторной работы]]], повлёкшей за собой непредвиденные последствия.

В отчёте восстановлена хронология событий и дана оценка умению курсанта действовать в соответствии с требованиями Российского филиала Фонда SCP, предъявляемыми к кандидатам в оперативные сотрудники Организации.

Дальнейшие материалы требуют корректировки в части свидетельских показаний непосредственных участников событий и могут быть изменены в связи с вновь открывшимися обстоятельствами.
Все комментарии очевидцев будут приобщены к основным материалам и соответствующим образом занесены в протокол.
[[/module]]


------


[[html]]
&lt;style&gt;
@import url(http://scpfoundation.ru/local--files/scp-0001-ru-s/style.css);
@import url(http://scpfoundation.ru/local--files/scp-0001-ru-s/style2.css);
&lt;/style&gt;

&lt;style type=&#34;text/css&#34;&gt;
       
      p.nonsel
        ::selection
        {
            background: #FFFFFF;
            text-shadow: none;
        }
        ::-moz-selection
        {
            background: #FFFFFF;
            text-shadow: none;
        } 
&lt;/style&gt;

&lt;div&gt;
        &lt;button id = &#34;aBtn0&#34; type=&#34;button&#34; onclick=&#34;changeLang()&#34;  style=&#34;cursor:pointer; font-face: &#39;Comic Sans MS&#39;; font-weight :bold; font-size: 10px; color: #0000FF; 
                         background-color: #FFGGAA; border: 1pt ridge lightgrey; width: 50px; display:none;&#34; &gt;
                EN
        &lt;/button&gt;

         &lt;br&gt;
         &lt;p id=&#34;enIntro&#34;  style=&#39;margin: 10px&#39; &gt; &lt;/p&gt;

        &lt;button id = &#34;aBtn1&#34; type=&#34;button&#34; onclick=&#34;showLab()&#34;  style=&#34;cursor:pointer; font-face: &#39;Comic Sans MS&#39;; font-weight :bold; font-size: 30px; color: #A30000; 
                         background-color: #FFGGAA; border: 3pt outset lightgrey; width: 99%;&#34; &gt;
                § приступить к изучению дела №SCP-0002-RU-S
        &lt;/button&gt;
&lt;/div&gt;


&lt;div id = &#34;aLab&#34;  style=&#34;display: none; background-color: #FFFFF0;&#34;&gt;

     &lt;div align=&#34;center&#34;;  style=&#34;font-weight :bold; font-size: 18px; color: #000;&#34;&gt;
          &lt;p id=&#34;aPage&#34;&gt;Header&lt;/p&gt;
     &lt;/div&gt;


    
     &lt;div style=&#39;float:right; margin: 10px&#39; &gt;
     &lt;table  class=&#34;wiki-content-table&#34;&gt;
          &lt;tr&gt;
               &lt;td&gt;
                    &lt;div align=&#34;center&#34;;  style=&#34;font-weight :bold; font-size: 12px; color: #000;&#34;&gt;
                         &lt;p id=&#34;pHead&#34;&gt;pic header&lt;/p&gt;
                    &lt;/div&gt;
              &lt;/td&gt;
         &lt;tr&gt;&lt;/tr&gt;
               &lt;td&gt;

                   &lt;table class=&#34;wiki-content-table&#34; id=&#39;tbl1&#39;&gt;
                        &lt;tr&gt;
                             &lt;td colspan=&#34;2&#34; &gt;
                                  &lt;div  align=&#34;center&#34; &gt;
                                       &lt;img src=&#39;&#39; alt=&#39;&#39; id=&#34;pic1&#34; height=&#39;176&#39; width=&#39;200&#39;  style=&#34;max-height:300px;max-width:400px;width: expression(this.width &gt; 400 ? 400: true);&#34;  class=&#34;image&#34;&gt;
                                  &lt;/div&gt;
                             &lt;/td&gt;
                             
                             &lt;td colspan = &#34;2&#34; &gt;
                                  &lt;div align=&#34;center&#34; &gt;
                                       &lt;img src=&#39;&#39; alt=&#39;&#39; id=&#34;pic2&#34; height=&#39;200&#39; width=&#39;200&#39; style=&#34;max-height:300px;max-width:400px;width: expression(this.width &gt; 400 ? 400: true);&#34;  class=&#34;image&#34;&gt;
                                  &lt;/div&gt;
                             &lt;/td&gt;
                       &lt;/tr&gt;
                       &lt;tr&gt;
                            &lt;th colspan=&#34;2&#34;&gt;
                                 &lt;sup&gt;&lt;div width = &#34;100%&#34; style=&#34;max-height:300px;max-width:400px;width: expression(this.width &gt; 400 ? 400: true);&#34; align = &#34;center&#34;&gt;
                                      &lt;p id=&#34;pic1t&#34;&gt;Location&lt;/p&gt;
                                 &lt;div&gt;&lt;/sup&gt;
                           &lt;/th&gt;
                           &lt;th colspan=&#34;2&#34;&gt;&lt;sup&gt;
                                &lt;div width = &#34;100%&#34; style=&#34;max-height:300px;max-width:400px;width: expression(this.width &gt; 400 ? 400: true);&#34; align = &#34;center&#34;&gt;
                                     &lt;p id=&#34;pic2t&#34;&gt;Encounter&lt;/p&gt;
                                &lt;div&gt;&lt;/sup&gt;
                           &lt;/th&gt;
                      &lt;/tr&gt;
                 &lt;/table&gt;
             &lt;/td&gt;
         &lt;/tr&gt;
          &lt;tr&gt;
               &lt;td&gt;
                    &lt;div align=&#34;center&#34;;  style=&#34;font-weight :bold; font-size: 12px; color: #000;&#34;&gt;
                         &lt;p id=&#34;pInv&#34;&gt;pic inventory&lt;/p&gt;
                    &lt;/div&gt;
              &lt;/td&gt;
         &lt;tr&gt;
    &lt;/table&gt;
    &lt;/div&gt;
    
    &lt;div align=&#34;left&#34;; style=&#39;margin: 10px&#39; &gt;
          &lt;label id=&#34;aHead&#34;&gt;Header&lt;/label&gt;
     &lt;/div&gt;
       

     &lt;p id=&#34;mainTxt&#34;  style=&#39;margin: 10px&#39; &gt;Loading...&lt;br&gt;Если вы видите этот текст вместо статьи, пожалуйста, смените браузер или попробуйте зайти на страницу с другого компьютера&lt;/p&gt;

     &lt;div id=&#34;tContainer&#34; style=&#39;float:left; margin:10px&#39;&gt;
       &lt;div style=&#39;float:left; margin: 10px&#39; id = &#39;varsTab&#39;&gt;
       &lt;table  class=&#34;wiki-content-table&#34;&gt;
          &lt;th&gt;
                    &lt;div align=&#34;center&#34;;  style=&#34;font-weight :bold; font-size: 12px; color: #000;&#34;&gt;
                         &lt;p id=&#34;tHead&#34;&gt;tab header&lt;/p&gt;
                    &lt;/div&gt;
             
         &lt;/th&gt;&lt;tr&gt;
               &lt;td&gt;
                    &lt;p id=&#34;tVars&#34;  style=&#39;margin: 10px&#39; &gt;Table1&lt;/p&gt;
               &lt;/td&gt;
         &lt;/tr&gt;
       &lt;/table&gt;
       &lt;/div&gt;

    &lt;/div&gt;
       &lt;br&gt; &lt;label id = &#39;fightField&#39;&gt;&lt;/label&gt;
     &lt;br&gt;
     &lt;button onClick=&#39;nextStep();&#39; id=&#39;nextBtn&#39;; disabled = true; style = &#39;width: 99%; font-weight :bold; font-size: 14px; cursor:pointer; background-color: #EEEEEE;  border: 1pt outset;&#39;&gt;NEXT&lt;/button&gt;


&lt;/div&gt;



&lt;script type=&#34;text/javascript&#34; src=&#34;http://scpfoundation.ru/local--files/scp-0002-ru-s/tsrs20.js&#34;&gt;&lt;/script&gt; 
&lt;script type=&#34;text/javascript&#34;&gt;

     //Global vars section
     //Global vars section
     var i;
     var k;
     var step = 0;
     var scp_id;
     var virus_id;
     var canPass = [0,0,0];
     var a_page = 0;
     var prev_step = 0;
     var prev_qid = 0;
     var quest_id = -1;     
     var lang = &#34;ru&#34;;
     var isV1_clk = 0;
     var isV2_clk = 0;
     var sum_Q1 = new Array(0);
     var sum_Q2 = new Array(0);
     var sum_Q3 = new Array(0);
     var sum_Q4 = new Array(0);
     var sum_Q5 = new Array(0);
     var casualties = 0;
     var fstClk =0;
     var nextStepVar =-1;
     var hasWatches = true;
     var params = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
     var levers = [0,1,0,1,0,0]
     var theTraitor;
     var didS2 = false;
     var monsterHealth = 10;
     var roomRed = [0,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;];
     var monEvaded = 0;
     var lastSuspect = -1;
     var ClickTime = Date.now();

     var enc_no = -1;     
     var time_left = 30;
     var allItems = [[true,false,&#39;Сигареты&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv001.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv002.png&#39;],
                          [false,false,&#39;Журнал «За рулём»&#39;,&#39;Личные дела сотрудников&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],
                          [false,false,&#39;Кофейная ягода&#39;,&#39;Клевер-четырёхлистник&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv021.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv022.png&#39;],
                          [false,false,&#39;Знание о монстрах и объектах&#39;,&#39;Знание плана 1-го этажа&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv031.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv032.png&#39;],
                          [false,false,&#39;Ключ от сейфа&#39;,&#39;Драгоценный камень&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv041.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv042.png&#39;],
                          [false,false,&#39;Компас&#39;,&#39;Ускоренные рефлексы&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv051.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv052.png&#39;],
                          [false,false,&#39;Бронежилет&#39;,&#39;Солнечные очки&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv061.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv062.png&#39;],
                          [false,false,&#39;Фотоаппарат&#39;,&#39;Знание кунг-фу&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv071.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv072.png&#39;],
                          [false,false,&#39;Знание плана 3-го этажа&#39;,&#39;Лупа&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv081.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv082.png&#39;],
                          [false,false,&#39;Костюм радиозащиты&#39;,&#39;Бутылка водки&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv091.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv092.png&#39;],
                          [false,false,&#39;Противорадиационные таблетки&#39;,&#39;Градусник&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv101.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv102.png&#39;],
                          [false,false,&#39;Отмычка&#39;,&#39;Фальшивый топаз&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv111.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv112.png&#39;],
                          [false,false,&#39;Схема эвакуации&#39;,&#39;Видеокамера&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv121.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv122.png&#39;],
                          [false,false,&#39;Справочник объектов SCP&#39;,&#39;Секундомер остановки времени&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv131.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv132.png&#39;],
                          [false,false,&#39;Защитные стальные пластины&#39;,&#39;Шприц с адреналином&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv141.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv142.png&#39;],
                          [false,false,&#39;Живая вода&#39;,&#39;Счётчик вероятностей&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv151.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv152.png&#39;],
                          [false,false,&#39;Револьвер с серебряной пулей&#39;,&#39;Снайперская винтовка&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv161.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv162.png&#39;],
                          [false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],[false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],
                          [false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],[false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],
                          [false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],[false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],
                          [false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],[false,false,&#39;&#39;,&#39;&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv011.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv012.png&#39;],
                          [false,false,&#39;Счётчик душ&#39;,&#39;Отчёт для служебного пользования&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv251.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv252.png&#39;],[false,false,&#39;&#39;,&#39;Секретный отчёт&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv261.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv262.png&#39;],
                          [false,false,&#39;Пароль&#39;,&#39;Совершенно секретный отчёт&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv0271.png&#39;,&#39;http://scpfoundation.ru/local--files/scp-0002-ru-s/Inv272.png&#39;]                         
 ];

     var health = 6;                
 
     var suspects = [ 
                            //0 status
                            [0,0,0,0,0,0,0,0,0,0],
 
                            //1 names
                            [&#34;Ведущий химик-лаборант &lt;a href=&#39;http://www.wikidot.com/user:info/DocFelix&#39;&gt;DocFelix&lt;/a&gt;&#34;,
                             &#34;Программист-консультант &lt;a href=&#39;http://www.wikidot.com/user:info/Eyskyaldi&#39;&gt;Eyskyaldi&lt;/a&gt;&#34;,
                             &#34;Доктор-психотерапевт &lt;a href=&#39;http://www.wikidot.com/user:info/Blackbird5154&#39;&gt;Blackbird5154&lt;/a&gt;&#34;,
                             &#34;Дежурный врач отделения &lt;a href=&#39;http://www.wikidot.com/user:info/V_V_Sector&#39;&gt;V_V_Sector&lt;/a&gt;&#34;,
                             &#34;Главный редактор отдела по связям с общественностью &lt;a href=&#39;http://www.wikidot.com/user:info/Jukka-Sarasti&#39;&gt;Jukka Sarasti&lt;/a&gt;&#34;,
                             &#34;Дежурный по испытательному полигону &lt;a href=&#39;http://www.wikidot.com/user:info/Lalartu&#39;&gt;Lalartu&lt;/a&gt;&#34;,
                             &#34;Военный техник &lt;a href=&#39;http://www.wikidot.com/user:info/theTBAPb&#39;&gt;theTBAPb&lt;/a&gt;&#34;,
                             &#34;Технолог по обработке металлов &lt;a href=&#39;http://www.wikidot.com/user:info/herr-raspel&#39;&gt;herr Raspel&lt;/a&gt;&#34;,
                             &#34;Шеф-повар столовой Зоны 7██ &lt;a href=&#39;http://www.wikidot.com/user:info/NakedBanana&#39;&gt;NakedBanana&lt;/a&gt;&#34;,
                             &#34;Лингвист-переводчик &lt;a href=&#39;http://www.wikidot.com/user:info/cleveremptY&#39;&gt;cleveremptY&lt;/a&gt;&#34;
                            ],
                            //2 avatars
                            [&#39;http://www.wikidot.com/avatar.php?userid=1403906&amp;timestamp=1432484062&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=2026632&amp;timestamp=1431543410&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=2074508&amp;timestamp=1431542925&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=2036330&amp;timestamp=1431542970&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1348041&amp;timestamp=1431543301&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1191487&amp;timestamp=1431543531&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1382229&amp;timestamp=1432224947&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1582074&amp;timestamp=1431543245&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1309991&amp;timestamp=1431543208&#39;,
                             &#39;http://www.wikidot.com/avatar.php?userid=1844401&amp;timestamp=1431543177&#39;
                            ],
                            //3 profiles
                           [&#39;Инженер, имеющий вместо правой руки латунный протез. Если прислушаться, его тело издает едва слышное тикание&#39;,
                             &#39;Самый крутой хакер Зоны 7██, прекрасно умеющий обращаться с программами любой сложности&#39;,
                             &#39;Доктор психиатрических наук, предпочитающая носить строгие классические костюмы, и презирающая курящих людей, взирая на них с высоты учения Фрейда&#39;,
                             &#39;Доктор прикладной медицины, отлично разбирающийся в анатомии и мастерски владеющий всеми видами холодного оружия&#39;,
                             &#39;Бойкий на язык, прекрасно владеющий грамматикой и орфографией сотрудник, издавший несколько художественных романов для популяризации идей Фонда в умах подрастающего поколения&#39;,
                             &#39;Управляющий испытательным полигоном лаборатории. Никто в своей жизни не видел столько мусора и безнадёжно сконструированных образцов объектов SCP, как он. Видимо отсюда произрастала его невероятная аккуратность и любовь к чистоте&#39;,
                             &#39;Бывший армейский снайпер, знающий от и до все образцы современного огнестрельного оружия&#39;,
                             &#39;Мастер на все руки. Может починить в кратчайшие сроки всё от искрящей проводки, до протекающих труб. Всегда носит с собой большой напильник&#39;,
                             &#39;Главный кулинар, лучший в своём деле. Умеет готовить самые изысканные блюда, но при этом, как ни странно, вегетарианец&#39;,
                             &#39;Специалист по иностранным языкам и прирождённый дипломат. Незаменим при работе с зарубежными филиалами Фонда&#39;
                            ],
                            //4 clues
                            [[&#39;судя по тому, что на месте преступления виднелись смазанные отпечатки обеих рук, :par07у диверсанта должны были быть:par08 крупные ладони&#39;,&#39;судя по тому, что на этаже был установлен экспериментальный сканер обоих ладоней, в базе данных должны были находиться отпечатки :par07обеих рук:par08 диверсанта&#39;],
                             [&#39;судя по увиденному, :par07диверсант плохо умел пользоваться компьютерами:par08&#39;,&#39;всё указывало на то, что :par07диверсант был откровенным ламером:par08&#39;],
                             [&#39;судя по окуркам вокруг, :par07диверсант много и часто курил:par08&#39;,&#39;судя по стоящей неподалёку переполненной пепельнице :par07диверсант курил:par08 дорогие кубинские сигары&#39;],
                             [&#39;судя по видимым на полу пятнам крови, :par07диверсант не смог хорошо перевязать свои царапины:par08&#39;,&#39;судя по валяющимся неподалёку неумело оторванным кускам бинта, :par07диверсант не умел перевязывать раны:par08&#39;],
                             [&#39;судя по записям, оставленным в выроненном им списке покупок, :par07диверсант был не в ладах с грамматикой:par08&#39;,&#39;судя по ошибкам в выроненной им страничке личного блокнота с кусочком текста гимна Организации, :par07диверсант знал русский язык на уровне первоклассника:par08&#39;],
                             [&#39;судя по оставленным жирным следам, :par07диверсант был неряхой:par08&#39;,&#39;судя по оставшимся вокруг следам грязи, :par07диверсант не особо следил за чистотой своей обуви:par08&#39;],
                             [&#39;судя по потерянной им книге «Основы стрелкового оружия», :par07диверсант не умел хорошо стрелять:par08&#39;,&#39;судя по забытым им на столе очкам с толстыми линзами, :par07диверсант был подслеповат:par08, возможно всю жизнь&#39;],
                             [&#39;судя по брошенной им в мусорной корзине остановившимся часам с логотипом Повстанцев Хаоса,:par07 диверсант не знал даже как поменять в них батарейку:par08&#39;,&#39;судя по забытому им самодельному браслету со следами грубой обработки, диверсант :par07не умел обращаться со столярными инструментами:par08&#39;],
                             [&#39;судя по недоеденному :par07бутерброду с ветчиной:par08, диверсант был не дурак перекусить на ходу&#39;,&#39;судя по надкушенному бутерброду с плесенью, :par07диверсант не мог нормально приготовить:par08 даже собственный обед&#39;],
                             [&#39;судя по томику забытого им словаря, :par07диверсант не знал даже основ английского:par08 языка&#39;,&#39;судя по ошибкам в английских словах в забытом им блокноте, :par07диверсант не знал этого языка:par08 слишком хорошо&#39;]
                            ],
                             //5 names only
                                [
                             &#34;&lt;b&gt;DocFelix&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;Eyskyaldi&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;Blackbird5154&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;V_V_Sector&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;Jukka Sarasti&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;Lalartu&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;theTBAPb&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;herr Raspel&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;NakedBanana&lt;/b&gt;&#34;,
                             &#34;&lt;b&gt;cleveremptY&lt;/b&gt;&#34;
                            ]
                          ];


     //Texts array
     var theTexts;
     var textsEn;



     //Determine plot story
     scp_id = Math.floor((Math.random() *10) + 0);   
     virus_id = Math.floor((Math.random() *10) + 0); 
     params[0] = Math.floor((Math.random() *10) + 1);
     params[1] = Math.floor((Math.random() *4) + 1); 
     params[2] = Math.floor((Math.random() *4) + 1); 
     params[3] = Math.floor((Math.random() *3) + 1);
     params[4] = Math.floor((Math.random() *3) + 1);
     theTraitor = Math.floor((Math.random() *10) + 0);
     theTexts = textsRu;
     for (i=0;i&lt;theTexts[15].length;i++){
         theTexts[15][i] = decodeText(theTexts[15][i]);
     }
     suspects[0][theTraitor] = 1;

function monDam(){monsterHealth = monsterHealth -1;}

function decodeText(txt_dec){
     var abcR = &#39;абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ&#39;;
     var abcE = &#39;アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムあいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむ&#39;;
     
     txt_dec=txt_dec.replace(/:the_traitor/gi, suspects[5][theTraitor]);


     txt_dec=txt_dec.replace(/:par09/gi, theTexts[13][9][1]);

     //replace variants
     txt_dec=txt_dec.replace(/:2scp_name/gi, theTexts[16][0][scp_id][2]);
     txt_dec=txt_dec.replace(/:scp_name/gi, theTexts[16][0][scp_id][0]);
     txt_dec=txt_dec.replace(/:virus_name/gi, theTexts[16][1][virus_id]);

     if (hasWatches == true) {
          txt_dec=txt_dec.replace(/:time_left/gi, time_left);
     } else {
          txt_dec=txt_dec.replace(/:time_left/gi, &#39;&lt;font color = &#34;darkred&#34;&gt;НЕИЗВЕСТНО&lt;/font&gt;&#39;);     
     }
     
     txt_dec=txt_dec.replace(/:par00/gi, theTexts[13][0][params[0]]); txt_dec=txt_dec.replace(/:par01/gi, theTexts[13][1][params[1]]); 
     txt_dec=txt_dec.replace(/:par02/gi, theTexts[13][2][params[2]]); txt_dec=txt_dec.replace(/:par03/gi, theTexts[13][3][params[3]]); txt_dec=txt_dec.replace(/:par04/gi, theTexts[13][4][params[4]]);

     if (allItems[1][1] == false){     
       txt_dec=txt_dec.replace(/:par07/gi, theTexts[13][7][0]); 
       txt_dec=txt_dec.replace(/:par08/gi, theTexts[13][8][0]); 
     } else {
       txt_dec=txt_dec.replace(/:par07/gi, theTexts[13][7][1]); 
       txt_dec=txt_dec.replace(/:par08/gi, theTexts[13][8][1]); 
     }

     if (allItems[2][1] == true){     
         txt_dec=txt_dec.replace(/:par15/gi, theTexts[13][15][1]); 
     } else {
         txt_dec=txt_dec.replace(/:par15/gi, theTexts[13][15][0]); 
     }


        
     txt_dec=txt_dec.replace(/:par10/gi, theTexts[13][10][1]); 
     
       
     if (allItems[9][0] == true){  
        txt_dec=txt_dec.replace(/:par12/gi, theTexts[13][12][1]);
     } else {
     
           if (allItems[10][0] == true){  
              txt_dec=txt_dec.replace(/:par12/gi, theTexts[13][12][2]);
           } else {     
              txt_dec=txt_dec.replace(/:par12/gi, theTexts[13][12][3]);
           }        
     }
     
     if (sum_Q4.length &gt;0) {
         txt_dec=txt_dec.replace(/:par14/gi,  theTexts[13][14][sum_Q4[0]]); 
         txt_dec=txt_dec.replace(/:par16/gi,  theTexts[13][16][sum_Q4[0]]); 
     }    

     if (prev_step == 21 || prev_step == 22) {
       if ( sum_Q4[0]==1 ||  sum_Q4[0]==3){
         if ( sum_Q4[1]==1 || sum_Q4[1]==3){         
            txt_dec=txt_dec.replace(/:par17/gi, theTexts[13][17][1]); 
         }
         if ( sum_Q4[1]==2 || sum_Q4[1]==4){         
            txt_dec=txt_dec.replace(/:par17/gi, theTexts[13][17][2]); 
         }
       } else {
         if ( sum_Q4[1]==1 || sum_Q4[1]==3){         
            txt_dec=txt_dec.replace(/:par17/gi, theTexts[13][17][3]); 
         }
         if ( sum_Q4[1]==2 || sum_Q4[1]==4){         
            txt_dec=txt_dec.replace(/:par17/gi, theTexts[13][17][4]); 
         }
       }
     }


     if (quest_id &gt;=0){
          txt_dec=txt_dec.replace(/:quest_id/gi, &#39;&lt;b&gt;&#39; + theTexts[7][quest_id][1] + &#39;&lt;/b&gt;&#39;); 
     }
     
     txt_dec=txt_dec.replace(/あ|い|う|え|お|か|き|く|け|こ|さ|し|す|せ|そ|た|ち|つ|て|と|な|に|ぬ|ね|の|は|ひ|ふ|へ|ほ|ま|み|む|ア|イ|ウ|エ|オ|カ|キ|ク|ケ|コ|サ|シ|ス|セ|ソ|タ|チ|ツ|テ|ト|ナ|ニ|ヌ|ネ|ノ|ハ|ヒ|フ|ヘ|ホ|マ|ミ|ム/gi, function mF(x){return abcR.substr(abcE.search(x),1);});

     return txt_dec;
}


function correctText(obj,newtext, aftermath_civ, aftermath_time, aftermath_health){
     newtext = newtext.replace(/\$/gi,&#34;&#39;&#34;);

     obj.innerHTML = &#34;&lt;s&gt;&#34; + obj.innerText + &#34;&lt;/s&gt; &#34; + decodeText(newtext);
     obj.style.fontWeight=&#34;normal&#34;;
     obj.style.color=&#34;#8B0000&#34;;
     obj.onclick = &#39;&#39;;
     obj.style.cursor = &#34;text&#34;;
     if (prev_step == 10  ){
        obj.style.color= &#39;#&#39; + theTexts[13][10][2];
     }
     
     var ranLet = &#39;_abcdefghijklmnopqrstuvwxyz_&#39;;
     roomRed[0] = roomRed[0] + 1;
     roomRed[prev_step + 1] = roomRed[prev_step + 1] + aftermath_civ.toString() + ranLet.substr(Math.floor((Math.random() *25) + 1),1) + aftermath_time.toString() + ranLet.substr(Math.floor((Math.random() *25) + 1),1) + aftermath_health.toString() + ranLet.substr(Math.floor((Math.random() *25) + 1),1);

     
     casualties = casualties + aftermath_civ;
     time_left = time_left + aftermath_time;
     health = health + aftermath_health;
 
     
     if (health &lt;=0){ health = 0; }
     if (health &gt;=9){ health = 9; }
 
     if (prev_step == 23 || prev_step == 24){     
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][prev_step][1] + monsterHealth + &#39;.png&#39;;
     } 

     //redraw timer
     if (step &gt;0){document.getElementById(&#34;pHead&#34;).innerHTML= decodeText(theTexts[3][prev_step] + &#34;&lt;br&gt; Самочувствие субъекта: &#34; + theTexts[14][health]);}

         
     var curInv = &#34;Содержимое инвентаря субъекта: &lt;br&gt;&lt;br&gt;&#34;; 
     for (i=0;i&lt;allItems.length;i++) {
       if (allItems[i][0]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][4] + &#34;&#39; title = &#39;&#34; + allItems[i][2] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
          if (allItems[i][1]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][5] + &#34;&#39; title = &#39;&#34; + allItems[i][3] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
       }
     curInv = curInv.slice(0, curInv.length - 2);         
     document.getElementById(&#34;pInv&#34;).innerHTML =  decodeText(curInv);
     
     if (allItems[25][0] == true) {
          document.getElementById(&#34;pHead&#34;).innerHTML=document.getElementById(&#34;pHead&#34;).innerHTML+ &#39;&lt;br&gt;Зарегистрированные загубленные души: &#39; + casualties + &#39; шт.&#39;;
     }     
     
         
}


function showLab(){
     document.getElementById(&#34;aLab&#34;).style.display = &#39;block&#39;;
     document.getElementById(&#34;aBtn1&#34;).style.display = &#39;none&#39;;
     document.getElementById(&#34;aBtn0&#34;).style.display = &#39;none&#39;;
}


function tConstruct(){

     var aTab = &#34;&lt;table class=&#39;wiki-content-table&#39; style=&#39;width:100%&#39;&gt;&#34;;
     var bTab;

     var row_count = Math.round((theTexts[8][quest_id].length - 1)/2);
     var v_type = theTexts[8][quest_id][0];
     var shuff = new Array(row_count);


     for (i=0; i&lt; row_count; i++) {
          shuff[i] = i*2 + 1;
     }
          
     if (theTexts[8][quest_id][2]==&#39;&#39;) {
       row_count = Math.round(row_count / 2);
     } else {
        //Shuffle if not splited
        shuff.sort(function() {return Math.random() - 0.5;});
     }
     
     for (i=1; i &lt;= row_count; i++){

        var var_val = (row_count * 2 + shuff[i-1] - 1);
        //if no comments then split columns
         if(theTexts[8][quest_id][2]==&#39;&#39;){
           var v_ind = row_count + i;
           
           bTab = &#34;&lt;td&gt;&lt;input type =&#39;&#34; + v_type + &#34;&#39; id=&#39;var&#34; + v_ind + &#34;&#39;  value= &#39;&#34; + var_val + &#34;&#39; name = &#39;variantsB&#39; onClick=&#39;varClicked(&#34; + quest_id + &#34;,2);&#39;&gt;&lt;label id=&#39;vcap&#34; + i +
                  &#34;&#39; for=&#39;var&#34; + v_ind + &#34;&#39;&gt;&#34; + decodeText(theTexts[8][quest_id][ row_count * 2 + shuff[i-1] ]) + &#34;&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#34;;

             //rewrite choosen hits into array
             var hit1 = Math.floor((Math.random() * row_count) + 1) - 1;
             var hit2 = Math.floor((Math.random() * row_count) + 1) - 1;
             for (k=0; k&lt; row_count; k ++){

               if (hit1 == k) {
                     theTexts[9][quest_id][k][0] = 1;
               } else {
                     theTexts[9][quest_id][k][0] = 0;
               }
               if (hit2 == k) {
                     theTexts[9][quest_id][row_count + k][0] = 1;
               } else {
                     theTexts[9][quest_id][row_count + k][0] = 0;
               }    

             }

         } else {
           bTab = &#34;&lt;td&gt;&lt;i&gt;&#34; + decodeText(theTexts[8][quest_id][ shuff[i-1] + 1 ]) + &#34;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&#34;;
         }
 
         var_val = (shuff[i-1] - 1);
         //buttons or not  
         if (theTexts[8][quest_id][0] == &#39;button&#39;) { 
              bTab = &#34;&lt;td&gt;&#34; + decodeText(theTexts[8][quest_id][ shuff[i-1] + 1 ]) + &#34;&lt;/td&gt;&lt;/tr&gt;&#34;;
         

              aTab = aTab+ 
                  &#34;&lt;tr&gt;&lt;td&gt;&lt;input type =&#39;&#34; + v_type + &#34;&#39; id=&#39;var&#34; + Math.round((shuff[i-1]+1)/2) + &#34;&#39; value= &#39;&#34; + decodeText(theTexts[8][quest_id][ shuff[i-1] ]) + &#34;&#39; name = &#39;variants&#39; onClick=&#39;butClicked(&#34; + shuff[i-1]  + &#34;);&#39;&gt;&lt;/td&gt;&#34; + bTab;

         //not button
         } else {
              aTab = aTab + 
                  &#34;&lt;tr&gt;&lt;td&gt;&lt;input type =&#39;&#34; + v_type + &#34;&#39; id=&#39;var&#34; + Math.round((shuff[i-1]+1)/2) + &#34;&#39; value= &#39;&#34; + var_val + &#34;&#39; name = &#39;variants&#39; onClick=&#39;varClicked(&#34; + quest_id + &#34;,1);&#39;&gt;&lt;label id=&#39;vcap&#34; +  Math.round((shuff[i-1]+1)/2)  +   &#34;&#39; for=&#39;var&#34; + Math.round((shuff[i-1]+1)/2) + &#34;&#39;&gt;&#34; + decodeText(theTexts[8][quest_id][ shuff[i-1] ]) + &#34;&lt;/label&gt;&lt;/td&gt;&#34; + bTab;
         }
     }
     aTab = aTab + &#34;&lt;/table&gt;&#34;;
 
    if (prev_step == 17 || prev_step == 18) {
    
       aTab = aTab + &#34; &lt;br&gt; &lt;button onClick=&#39;doInj();&#39; id=&#39;butInj&#39;; disabled = true; style = &#39;width: 99%; font-weight :bold; font-size: 14px; cursor:pointer; background-color: #EEEEEE; color: grey; border: 1pt outset;&#39;&gt;Создать вакцину&lt;/button&gt;&#34;;
      
    }



 
     document.getElementById(&#34;tVars&#34;).innerHTML = aTab;
   

          document.getElementById(&#34;nextBtn&#34;).disabled = true;
          document.getElementById(&#34;nextBtn&#34;).style.color = &#39;grey&#39;;
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;block&#39;;
}

//inject vaccine
function doInj() {
     var perc = getSum(quest_id);
     var vacCol;
     var addTxt;
     var VHN;
     var FCol;
     perc =  parseInt(perc)*1 +  parseInt(sum_Q3[0])*1 +  parseInt(sum_Q3[1])*1;
     if (perc ==100){FCol = &#39;#003300&#39;; vacCol = &#39;сияющий изумрудно-зелёный&#39;; addTxt = &#39;Стажёр едва не подпрыгнул от радости, чувствуя, как в груди начало, словно бешеное, колотиться сердце&#39;; health = health + 2;VHN=3;}
     if (perc &lt;90){FCol = &#39;#006600&#39;; vacCol = &#39;насыщенный зелёный&#39;; addTxt = &#39;Стажёр удовлетворённо потёр руки, почувствовав облегчение&#39;;health = health + 1;VHN=3;}     
     if (perc &lt;80){FCol = &#39;#00FF00&#39;; vacCol = &#39;зелёный&#39;; addTxt = &#39;Стажёр удовлетворённо потёр руки, почувствовав облегчение&#39;;health = health + 1;VHN=3;}          
     if (perc &lt;70){FCol = &#39;#66FF66&#39;; vacCol = &#39;зеленоватый&#39;; addTxt = &#39;Стажёр недовольно поморщился от её вида&#39;;VHN=2;}
     if (perc &lt;60){FCol = &#39;#CCFF33&#39;; vacCol = &#39;жёлто-зелёный&#39;; addTxt = &#39;Стажёр недовольно поморщился от её вида&#39;;VHN=2;}
     if (perc &lt;50){FCol = &#39;#FFFF00&#39;; vacCol = &#39;жёлтый&#39;; addTxt = &#39;Стажёр недовольно поморщился от её вида&#39;;VHN=2;}
     if (perc &lt;40){FCol = &#39;#FFCC00&#39;; vacCol = &#39;жёлто-оранжевый&#39;; addTxt = &#39;Стажёр недовольно поморщился от её вида&#39;; VHN=2;}     
     if (perc &lt;30){FCol = &#39;#FF6600&#39;; vacCol = &#39;оранжевый&#39;; addTxt = &#39;Стажёру стало дурно от одного его вида&#39;; health = health - 1;VHN=1;}
     if (perc &lt;20){FCol = &#39;#FF0000&#39;; vacCol = &#39;красный&#39;; addTxt = &#39;Стажёру стало дурно от одного его вида&#39;; health = health - 1;VHN=1;}
     if (perc &lt;10){FCol = &#39;#800000&#39;; vacCol = &#39;бордово-красный&#39;; addTxt = &#39;Стажёра едва не стошнило на пол от одного её вида&#39;; health = health - 2; VHN=1;}


     

     if (prev_step == 17) {
       document.getElementById(&#34;injDiv1&#34;).innerHTML = decodeText(&#34;&lt;br&gt;&lt;br&gt;Кадет закончил приготовления, перелил полученную микстуру в колбу и добавил в неё каплю слюны заражённого для получения контраста. Жидкость в пробирке моментально приобрела &lt;span style = &#39;background-color: &#34; +FCol +&#34;&#39;&gt;&lt;b&gt;&#34; + vacCol + &#34;&lt;/b&gt;&lt;/span&gt; цвет. &#34; + addTxt + &#34; Не теряя времени, он отдал получившееся лекарство врачам и поспешил подняться по лестнице наверх.&#34;);
       
       
     }
     if (prev_step == 18){  
       document.getElementById(&#34;injDiv2&#34;).innerHTML = decodeText(&#34;&lt;br&gt;&lt;br&gt;Кадет закончил приготовления, истёр все свои таблетки в пудру и пересыпал её в небольшой холщовый мешочек. Пудра внутри постепенно приобрела &lt;span style = &#39;background-color: &#34; +FCol +&#34;&#39;&gt;&lt;b&gt;&#34; + vacCol + &#34;&lt;/b&gt;&lt;/span&gt; цвет. &#34; + addTxt + &#34;. Не теряя времени, он начал продираться сквозь мычащее и скрежещущее зубами стадо, по пути рассыпая на головы больных свой чудо-порошок, а затем поднялся по лестнице на крышу, заперев за собой дверь.&#34;);
     }
     
          document.getElementById(&#34;nextBtn&#34;).disabled = false;
          document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
          document.getElementById(&#34;butInj&#34;).disabled = true;
          document.getElementById(&#34;butInj&#34;).style.color = &#39;grey&#39;;
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][prev_step][1];
}




function butClicked(nmb){
  var quests = new Array(0);

    //correct answer
    if (nmb ==1) {
         //Find room quests
         for (i=0;  i&lt;theTexts[7].length; i++){
            if (theTexts[7][i][0] == prev_step) {
               quests.push(i);
            }
         }

        k=0;
        var quest_id2   = Math.floor((Math.random() * quests.length) + 1)-1; 
        while (quests[quest_id2]==quest_id &amp;&amp; k &lt; 100){
             k =  k+1;
             quest_id2   =Math.floor((Math.random() * quests.length) + 1) -1;  
         } 

      //renew suspects
          k = Math.floor((Math.random() *10) + 0);
           while (suspects[0][k] != 0) {
               k = Math.floor((Math.random() *10) + 0);
           }
           suspects[0][k] = -2; 

      if (prev_step == 11){   
           document.getElementById(&#34;mainTxt&#34;).innerHTML=          document.getElementById(&#34;mainTxt&#34;).innerHTML + &#34;&lt;br&gt;&lt;br&gt;&#34;+
              decodeText(&#34;«Очень хорошо, - продолжил тот же голос – вы успешно ответили на наш вопрос, поэтому &#34; +suspects[1][k] + &#34; ещё немного поживёт, однако ваш голос не распознан нашей системой. Пожалуйста, ответьте на дополнительный контрольный вопрос: «&lt;b&gt;&#34; + theTexts[7][quests[quest_id2]][1] + &#34;&lt;/b&gt;» или мы будем вынуждены убить одного из ваших коллег в наказание за попытку обмана. Если ответ будет верным, то мы его просто допросим и отпустим восвояси».&lt;br&gt;&lt;br&gt;Лисицын понял, что названного голосом на том конце трубки сотрудника можно с чистой совестью исключить из списка подозреваемых, и отправил ему сообщение об отмене встречи на крыше. Он гадал, кто же был второй жертвой. Как бы Лисицын не ответил на вопрос, второй невиновный сотрудник тоже не смог бы теперь прийти на встречу на крыше, однако в случае верного ответа он хотя бы остался бы жив. В любом случае отступать и класть трубку было уже поздно, и кадету теперь необходимо было дать собеседнику хотя бы какой-нибудь ответ.&#34;); 
           //add 1 point
           sum_Q2[0] = sum_Q2[0] + 1;
        } 
      if (prev_step == 12){   
           document.getElementById(&#34;mainTxt&#34;).innerHTML=          document.getElementById(&#34;mainTxt&#34;).innerHTML + &#34;&lt;br&gt;&lt;br&gt;&#34;+
              decodeText(&#34;«Ответ неверен, – к удовольствию Лисицына отрапортовала система – &#34; +suspects[1][k] + &#34; исключается из проведения опыта по причине ошибки оператора. Перехожу к запасному добровольцу, согласно плану Б. Начинаю предварительную пристрелку». Изображение камеры переместилось к пожарной лестнице, по которой другой человечек в белом халате пытался подняться наверх. (В этом месте Лисицын пожалел, что не знал о таком простом способе попасть на крышу). Через секунду экран вспыхнул белым светом, и человечек упал на землю, схватившись за ногу. На мониторе высветилась сообщение «Испытания системы в полную силу начнутся автоматически в течение одной минуты или &lt;b&gt;как только оператор успешно введёт табельный номер сотрудника Российского филиала&lt;/b&gt; для ручного запуска». Теперь у стажёра не было выбора: он должен был дать системе второй &lt;b&gt;неверный&lt;/b&gt; ответ, чтобы спасти жизнь бедолаге.&#34;); 
           //add 1 point
           sum_Q2[0] = sum_Q2[0] + 1;
        }         
        theTexts[8][quests[quest_id2]][0]=&#39;radio&#39;;
        quest_id = quests[quest_id2];

        
        tConstruct();
        

    } else {
     
     //incorrect button
     if (prev_step == 11){   
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
           document.getElementById(&#34;mainTxt&#34;).innerHTML=          document.getElementById(&#34;mainTxt&#34;).innerHTML + &#34;&lt;br&gt;&lt;br&gt;&#34;+
              decodeText(&#34;«Акт агрессии со стороны враждебной организации распознан успешно, - продолжил тот же голос –  в наказание один из сотрудников, числящихся в ней, будет устранён нашей оперативной группой. Приятного дня.».&lt;br&gt;&lt;br&gt;В трубке раздались длинные гудки, и Лисицын понял, что только что расплатился чьей-то жизнью за свою самонадеянность.&#34;); 
           casualties = casualties + 1;
     }
     
     if (prev_step == 12){   
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
           document.getElementById(&#34;mainTxt&#34;).innerHTML=          document.getElementById(&#34;mainTxt&#34;).innerHTML + &#34;&lt;br&gt;&lt;br&gt;&#34;+
              decodeText(&#34;«Ответ принят», – высветилось сообщение на мониторе. Лисицын увидел, как экран вспыхнул и побелел. Когда изображение вернулось в норму, на крыше осталось одно лишь чёрное пятно на том месте, где совсем недавно стоял человек.&#34;);
 
           casualties = casualties + 1;
     }
     
     
    }
}

function varClicked(quest_id,varNo){

  var may_go = 0;
  var clickedVar;
  var fightTxt;
  monDef = Math.floor((Math.random() * 3) + 1);
  monAtt = Math.floor((Math.random() * 3) + 1) + 3;
  
  
  if (varNo == 1) {isV1_clk = 1;}
  if (varNo == 2) {isV2_clk = 1;}

  if(theTexts[8][quest_id][2]==&#39;&#39; &amp;&amp; isV1_clk == 1 &amp;&amp; isV2_clk == 1){
     if (prev_step == 24){     
        isV1_clk = 0; isV2_clk = 0;

        //evade sequence for monster is not allowed
        if (monEvaded == 1) {monDef = -1; monEvaded = 0; }

          for (i=1;i&lt;=3;i++){
          
             if (document.getElementById(&#34;var&#34; + i).checked == true) {
              fightTxt = &#39;&lt;br&gt;&#39;+theTexts[13][17+i][Math.floor((Math.random() * (theTexts[13][17+i].length -1)) + 1) ];
                if (monDef  == i) { 
                  fightTxt = fightTxt +&#39;, &#39; + theTexts[13][24][Math.floor((Math.random() * (theTexts[13][24].length -1)) + 1) ];
                  //hit item
                  if(allItems[7][1]==true){
                     allItems[7][1]=false;
                     fightTxt = fightTxt + &#39;. К счастью, курсант &lt;font color = \&#39;orange\&#39;&gt;&lt;b&gt;применил&lt;/b&gt;&lt;/font&gt; имеющееся у него &#39; + allItems[7][3] + &#39;, и намеченный им удар всё-таки достиг цели&#39;;
                     monDam();
                  } else {
                      if(allItems[13][0]==true){
                         allItems[13][0]=false;
                         fightTxt = fightTxt + &#39;. К счастью, курсант &lt;font color = \&#39;orange\&#39;&gt;&lt;b&gt;вспомнил&lt;/b&gt;&lt;/font&gt; схему движений врага, знание которой ему дал &#39; + allItems[13][2] + &#39;, и намеченный им удар всё-таки достиг цели&#39;;
                         monDam();
                      } else { 
                        monEvaded = 1;  
                      }                  
                  }
                } else {
                  fightTxt = fightTxt +&#39;, &#39; + theTexts[13][25][Math.floor((Math.random() * (theTexts[13][25].length -1)) + 1) ];  
                  monDam();
                } 
               
             }
             document.getElementById(&#34;var&#34; + i).checked = false;
          }
 
          for (i=4;i&lt;=6;i++){
          
             if (document.getElementById(&#34;var&#34; + i).checked == true) {
              fightTxt = fightTxt + &#39;. В свою очередь &#39; +theTexts[13][20+monAtt -3][Math.floor((Math.random() * (theTexts[13][20+monAtt -3].length -1)) + 1) ] + &#39;, &#39;;
                if (monAtt  == i ) {
                  fightTxt = fightTxt + theTexts[13][24][Math.floor((Math.random() * (theTexts[13][24].length -1)) + 1) ];
                } else {

                  fightTxt = fightTxt + theTexts[13][25][Math.floor((Math.random() * (theTexts[13][25].length -1)) + 1) ];
                  health = health - 1;

                     if(allItems[5][1]==true){
                        allItems[5][1]=false; 
                        health = health + 1;
                        fightTxt = fightTxt + &#39;. К счастью, курсант &lt;font color = \&#39;blue\&#39;&gt;&lt;b&gt;применил&lt;/b&gt;&lt;/font&gt; приобретённые им &#39; + allItems[5][3] + &#39;, и намеченный удар соперника всё-таки не достиг своей цели&#39;;
                      } else {
                       if(allItems[6][0]==true){
                          allItems[6][0]=false; 
                          health = health + 1;
                          fightTxt = fightTxt + &#39;. К счастью, на курсанте был &lt;font color = \&#39;blue\&#39;&gt;&lt;b&gt;надет&lt;/b&gt;&lt;/font&gt; &#39; + allItems[6][2] + &#39;, поглотивший основной удар врага&#39;;
                        } else 
                         if(allItems[14][0]==true){
                            allItems[14][0]=false; 
                            health = health + 1;
                            fightTxt = fightTxt + &#39;. К счастью, на курсанте были &lt;font color = \&#39;blue\&#39;&gt;&lt;b&gt;надеты&lt;/b&gt;&lt;/font&gt; &#39; + allItems[14][2] + &#39;, вобравшие в себя основную силу удара врага&#39;;
                          }
                        
                      }                                       
 

                }              
             
             }
             document.getElementById(&#34;var&#34; + i).checked = false;
          }          
 
  

                 
                 
          fightTxt = fightTxt + &#39;.&#39;;

          //you-re-dead 
          if (health&lt;0) {
             health = 0;
             params[26] = 1;
             if(allItems[14][1]==true){ allItems[14][1]= false;
              health = health + Math.floor((Math.random() * 3) + 1);
              fightTxt =  fightTxt + &#39;Когда сердце кадета уже почти остановилось, последним волевым усилием он&lt;font color = \&#39;blue\&#39;&gt;&lt;b&gt; выхватил&lt;/b&gt;&lt;/font&gt; найденный им шприц с адреналином, и воткнул себе его иглу прямо в центр груди. Это придало ему ещё толику сил, чтобы продолжить бой.&#39;;
             } else {

               fightTxt =  fightTxt + &#39;&lt;br&gt; Пошатнувшись от последнего попадания, курсант упал на колени, затем повалился на бок, упал на землю и &lt;font color=\&#39;darkred\&#39;&gt;&lt;b&gt;умер&lt;/b&gt;&lt;/font&gt;.&#39; 
               document.getElementById(&#34;nextBtn&#34;).disabled = false;
               document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
 


             } 
          }   
          //monster-is-dead
          if (monsterHealth&lt;1) {
             params[27] = 1;
               fightTxt =  fightTxt + &#39;&lt;br&gt; Проклятый монстр, получив финальный удар, издал протяжный вой, опрокинулся на спину и &lt;font color=\&#39;darkred\&#39;&gt;&lt;b&gt;испустил дух&lt;/font&gt;.&#39; 
          if(params[26]!=1){               fightTxt =  &#39;&lt;b&gt;Финал:&lt;/b&gt;&lt;br&gt;&#39; +fightTxt + &#39;&lt;br&gt; Пошатываясь от полученных ранений, победитель подошел к пульту и повернул рычаг, заглушающий реактор.&#39; }
             document.getElementById(&#34;nextBtn&#34;).disabled = false;
              document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
          }                   


         //document.getElementById(&#34;fightField&#34;).style.fontSize = &#34;x-Small&#34;;
             
                 //redraw timer
                 if (step &gt;0){document.getElementById(&#34;pHead&#34;).innerHTML= decodeText(theTexts[3][prev_step] + &#34;&lt;br&gt; Самочувствие субъекта: &#34; + theTexts[14][health]);}


                 if (allItems[25][0] == true) {

                          document.getElementById(&#34;pHead&#34;).innerHTML=document.getElementById(&#34;pHead&#34;).innerHTML + &#39;&lt;br&gt;Зарегистрированные загубленные души: &#39; + casualties + &#39; шт.&#39;;
 
                 }     

                 if (params[26]==1){
                    var re = new RegExp(decodeText(theTexts[14][0]),&#34;gi&#34;);
                    var Ntxt =  document.getElementById(&#34;pHead&#34;).innerHTML.replace(re,&#39;&lt;span style=&#34;background-color:#838383&#34;&gt;Погиб при исполнении&lt;/span&gt;&#39;);
                    document.getElementById(&#34;pHead&#34;).innerHTML=Ntxt; 
                 }


                 var curInv = &#34;Содержимое инвентаря субъекта: &lt;br&gt;&lt;br&gt;&#34;; 
                 for (i=0;i&lt;allItems.length;i++) {
                   if (allItems[i][0]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][4] + &#34;&#39; title = &#39;&#34; + allItems[i][2] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
                      if (allItems[i][1]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][5] + &#34;&#39; title = &#39;&#34; + allItems[i][3] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
                   }
                 curInv = curInv.slice(0, curInv.length - 2);         
                 document.getElementById(&#34;pInv&#34;).innerHTML =  decodeText(curInv);      

          params[24] =        params[24]  + 1; 
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][prev_step][1] + monsterHealth + &#39;.png&#39;;
          document.getElementById(&#34;fightField&#34;).innerHTML=   &#39;&lt;b&gt;Раунд &#39; +params[24] +&#39;:&lt;/b&gt; &#39;+ decodeText(fightTxt) + &#39;&lt;br&gt;&#39;+ document.getElementById(&#34;fightField&#34;).innerHTML ;

                                
     } 

  } else {

    if(theTexts[8][quest_id][0] == &#39;checkbox&#39;){
       i = 0;
       
       while (i&lt;= Math.round((theTexts[8][quest_id].length - 1)/2) &amp;&amp; may_go ==0) {
          i++;
          var elnam = &#34;var&#34; + i.toString();

          if (  document.getElementById(elnam).checked) {
               may_go = 1;

          }
          if (may_go ==1) {
               document.getElementById(&#34;nextBtn&#34;).disabled = false;
               document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;

               if (prev_step == 17 || prev_step == 18) { 
                  document.getElementById(&#34;nextBtn&#34;).disabled = true; 
                  document.getElementById(&#34;butInj&#34;).disabled = false;
                  document.getElementById(&#34;butInj&#34;).style.color = &#39;black&#39;;                  
                  document.getElementById(&#34;nextBtn&#34;).style.color = &#39;grey&#39;;
               }
          } else {
               document.getElementById(&#34;nextBtn&#34;).disabled = true; 
               document.getElementById(&#34;nextBtn&#34;).style.color = &#39;grey&#39;;               
               document.getElementById(&#34;nextBtn&#34;).disabled = true; 
               if (prev_step == 17 || prev_step == 18) { 
                   document.getElementById(&#34;butInj&#34;).style.color = &#39;grey&#39;;
                   document.getElementById(&#34;butInj&#34;).disabled = true;
               }

               
          }     
       }
       

       
    
    } else { 
      if(theTexts[8][quest_id][2]!=&#39;&#39;){
           document.getElementById(&#34;nextBtn&#34;).disabled = false;
      }
    }
  }
         if (document.getElementById(&#34;nextBtn&#34;).disabled == false) {
              document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
         }
     
}


function getSum(quest_id){
   var total_score = 0;
   var hitA = 0;

   if (quest_id &gt;=0 ) {
     for (i=0; i&lt;  theTexts[9][quest_id].length; i++){

        if (document.getElementById(&#34;var&#34; + (i + 1).toString()).checked){
           //splitted scoreboard
           if (theTexts[8][quest_id][2]==&#39;&#39;) {
               if (total_score == 1  &amp;&amp; i &lt;= theTexts[9][quest_id].length / 2){
                   hitA = 1; total_score = 0;
               } else {
                 if (hitA == 0) {
                    if (total_score == 0) {
                          total_score = 0; //0 hits
                     } else {
                          total_score = 2; //2nd hit
                     } 
                 } else {
                     if (total_score == 1) {
                      total_score = 1; //1st hit
                     } else {
                      total_score = 3; //1st + 2nd hits
                     } 
                 } 
               }
           } else {
            //normal scoreboard
            total_score = total_score + theTexts[9][quest_id][i][0];
            casualties = casualties + theTexts[9][quest_id][i][2];
            time_left = time_left + theTexts[9][quest_id][i][1];
           }

        }
     }
   } 


   //renew suspects
   if ((prev_step == 3 || prev_step == 4 || prev_step == 11 || prev_step == 12) &amp;&amp; total_score == 1) {

     k = Math.floor((Math.random() *10) + 0);
      while (suspects[0][k] != 0) {
         k = Math.floor((Math.random() *10) + 0);

      }
     suspects[0][k] = -2;                                         //-1

     if (prev_step == 3 || prev_step == 4){ 
        while (suspects[0][k] != 0) {
           k = Math.floor((Math.random() *10) + 0);

        }
        suspects[0][k] = -2;                                        //-2
     }



   }

   return total_score;
}

function replaceEng(obj){
 var e;
     theTexts[2][prev_step]=theTexts[2][prev_step].replace(/:par09/gi, theTexts[13][9][2]);
     if (prev_step == 9) {
          tConstruct();
             if (allItems[3][0] == false){     
                 theTexts[13][9][2]=theTexts[13][9][2].replace(/:par11/gi, decodeText(theTexts[13][11][1])); 
             } else {
                 theTexts[13][9][2]=theTexts[13][9][2].replace(/:par11/gi, decodeText(theTexts[13][11][2])); 
                 allItems[3][0] = false;
                 removeVar(allItems[3][2]);
             }              
          document.getElementById(&#34;mainTxt&#34;).innerHTML=  document.getElementById(&#34;mainTxt&#34;).innerHTML + &#34;&lt;br&gt;&lt;br&gt;&#34; + decodeText(theTexts[13][9][2]);
     }
     if (prev_step == 10) {
         obj.style.cursor = &#34;text&#34;;

         
         if (allItems[6][1] == true){
            obj.onclick = &#39;&#39;;
            allItems[6][1] = false;
            obj.innerHTML=decodeText(&#39;&lt;font color=&#34;#8B0000&#34;&gt;&lt;s&gt; но ничего не мог поделать.&lt;/s&gt;&lt;/font&gt;Лишь случайно запустив руку в карман, он наткнулся на найденные им несколько минут назад солнечные очки. После того, как он нацепил их себе на нос, ему стало гораздо легче видеть всё вокруг. &#39;);
            if(document.getElementById(&#34;s1&#34;)){
              document.getElementById(&#34;s1&#34;).style.color=  &#39;#000000&#39;;
     
             }
            if(document.getElementById(&#34;s2&#34;)){
              document.getElementById(&#34;s2&#34;).style.color=  &#39;#8B0000&#39;;
       
             }            
            if(document.getElementById(&#34;s3&#34;)){
              document.getElementById(&#34;s3&#34;).style.color=  &#39;#8B0000&#39;;

             }
        
            theTexts[13][10][2]=&#34;8B0000&#34;;
                       document.getElementById(&#34;tContainer&#34;).style.color = &#34;#000000&#34;;
                       document.getElementById(&#34;tHead&#34;).style.color = &#34;#000000&#34;;

            
               var curInv = &#34;Содержимое инвентаря субъекта: &lt;br&gt;&lt;br&gt;&#34;; 
               for (i=0;i&lt;allItems.length;i++) {
                 if (allItems[i][0]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][4] + &#34;&#39; title = &#39;&#34; + allItems[i][2] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
                    if (allItems[i][1]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][5] + &#34;&#39; title = &#39;&#34; + allItems[i][3] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
                 }
               curInv = curInv.slice(0, curInv.length - 2);         
               document.getElementById(&#34;pInv&#34;).innerHTML =  decodeText(curInv);            
            
         } else {
            obj.innerHTML=decodeText(&#39;&lt;font color=&#34;#FF9999&#34;&gt;&lt;s&gt; но ничего не мог поделать. &lt;/s&gt;&lt;/font&gt;&lt;font color = &#34;#CCCCB2&#34;&gt;он попытался найти у себя в карманах что-нибудь для защиты глаз, но у него ничего при себе не было. &lt;/font&gt;&#39;);
            obj.onclick = &#39;&#39;;
         }
     }          
     if (prev_step == 14 || prev_step == 9){
            if(document.getElementById(&#34;s0&#34;)){document.getElementById(&#34;s0&#34;).onclick=&#39;&#39;;}
            if(document.getElementById(&#34;s1&#34;)){document.getElementById(&#34;s1&#34;).onclick=&#39;&#39;;}
            if(document.getElementById(&#34;s2&#34;)){document.getElementById(&#34;s2&#34;).onclick=&#39;&#39;;}
            if(document.getElementById(&#34;s3&#34;)){document.getElementById(&#34;s3&#34;).onclick=&#39;&#39;;}
            if(document.getElementById(&#34;s4&#34;)){document.getElementById(&#34;s4&#34;).onclick=&#39;&#39;;}
            if(document.getElementById(&#34;s5&#34;)){document.getElementById(&#34;s5&#34;).onclick=&#39;&#39;;}
     }

}

function removeVar(remReason){
   var marked = 0;
   var lookVar = 0;
   
   if (prev_step == 19 || prev_step == 20) {
       lookVar = -1;
   }
 
   if (quest_id &gt;=0 ) {

      //splitted scoreboard
      if (theTexts[8][quest_id][2]==&#39;&#39; &amp;&amp; i &gt; theTexts[9][quest_id].length / 2) {

          for (i=0; i&lt;  theTexts[9][quest_id].length; i++){
         
             
           }
      }  else {
               //mark random not 1st answer
               k = Math.floor((Math.random() * (theTexts[9][quest_id].length) -1) + 1);
               var esc_c = 0;
               while (document.getElementById(&#34;var&#34; + (k + 1).toString()).value == lookVar &amp;&amp; esc_c &lt; 100){
                  esc_c =esc_c++;
                  k = Math.floor((Math.random() * (theTexts[9][quest_id].length) -1) + 1);
               } 
               document.getElementById(&#34;vcap&#34; + (k + 1).toString()).innerHTML = document.getElementById(&#34;vcap&#34; + (k + 1).toString()).innerHTML + &#39;&lt;b&gt; [вариант неверен (&#39; + remReason + &#39;)]&lt;b&gt;&#39;;
      } 
   }   

}


function changeLang(){
      if (lang == &#34;ru&#34;) {
          document.getElementById(&#34;aBtn0&#34;).innerText = &#34;RU&#34;;
          document.getElementById(&#34;enIntro&#34;).innerHTML = &#34;PLOT story&#34;;
          document.getElementById(&#34;aBtn1&#34;).innerText = &#34;START&#34;;   
          lang = &#34;en&#34;;
          theTexts = textsRu;
      }
      else {
          document.getElementById(&#34;aBtn0&#34;).innerText = &#34;EN&#34;;
          document.getElementById(&#34;enIntro&#34;).innerHTML = &#34;&#34;;
          document.getElementById(&#34;aBtn1&#34;).innerText= &#34;СТАРТ&#34;; 
          lang = &#34;ru&#34;;
          theTexts = textsEn;
      }

}

function butClick(sndr){
    var allOk = false;
    var butdesc = &#39;&#39;;

     if ((Date.now() - ClickTime)/1000&lt;1) { return;}
     ClickTime = Date.now();

       switch (sndr.id.toString()) {
          case &#39;b01&#39;:            if (params[0]==1 || params[0]==2){allOk=true;canPass[0]=1;} butdesc = &#39;солнца&#39;; break;
          case &#39;b02&#39;:            if (params[0]==3 || params[0]==4){allOk=true;canPass[0]=1;} butdesc = &#39;зонта&#39;; break;
          case &#39;b03&#39;:            if (params[0]==5 || params[0]==6){allOk=true;canPass[0]=1;} butdesc = &#39;снеговика&#39;; break;
          case &#39;b04&#39;:            if (params[0]==7 || params[0]==8){allOk=true;canPass[0]=1;} butdesc = &#39;ветра&#39;; break; 
          case &#39;b05&#39;:            if (params[0]==9 || params[0]==10){allOk=true;canPass[0]=1;} butdesc = &#39;облака&#39;; break;
          case &#39;b11&#39;:            if (params[1]==1){allOk=true;canPass[1]=1;} butdesc = &#39;знака севера&#39;; break;
          case &#39;b12&#39;:            if (params[1]==2){allOk=true;canPass[1]=1;} butdesc = &#39;знака юга&#39;; break;
          case &#39;b13&#39;:            if (params[1]==3){allOk=true;canPass[1]=1;} butdesc = &#39;знака запада&#39;; break;
          case &#39;b14&#39;:            if (params[1]==4){allOk=true;canPass[1]=1;} butdesc = &#39;знака востока&#39;; break;
          case &#39;b21&#39;:            if (params[2]==1){allOk=true;canPass[1]=1;} butdesc = &#39;красного пятна&#39;; break;
          case &#39;b22&#39;:            if (params[2]==2){allOk=true;canPass[1]=1;} butdesc = &#39;синего пятна&#39;; break;
          case &#39;b23&#39;:            if (params[2]==3){allOk=true;canPass[1]=1;} butdesc = &#39;желтого пятна&#39;; break;
          case &#39;b24&#39;:            if (params[2]==4){allOk=true;canPass[1]=1;} butdesc = &#39;оранжевого пятна&#39;; break;
          case &#39;b31&#39;:            if (params[3]==1){allOk=true;canPass[2]=1;} butdesc = &#39;круга&#39;; break;
          case &#39;b32&#39;:            if (params[3]==2){allOk=true;canPass[2]=1;} butdesc = &#39;квадрата&#39;; break;
          case &#39;b33&#39;:            if (params[3]==3){allOk=true;canPass[2]=1;} butdesc = &#39;треугольника&#39;; break;
          case &#39;b41&#39;:            if (params[4]==1){allOk=true;canPass[2]=1;} butdesc = &#39;жидкости&#39;; break;
          case &#39;b42&#39;:            if (params[4]==2){allOk=true;canPass[2]=1;} butdesc = &#39;твёрдого тела&#39;; break;
          case &#39;b43&#39;:            if (params[4]==3){allOk=true;canPass[2]=1;} butdesc = &#39;газа&#39;; break;
        }
    
      //hide safe
      if (allOk != true || (allOk == true &amp;&amp; fstClk == 0) ){
        if ( fstClk != 0){
          document.getElementById(&#34;safe&#34;).style.display = &#39;none&#39;;
          document.getElementById(&#34;csafe&#34;).innerHTML = document.getElementById(&#34;csafe&#34;).innerHTML + decodeText(&#39;Лисицын нажал на кнопку с изображением &#39; + butdesc + &#39;, и панель издала противный звук, после чего табло на ней погасло. Все дальнейшие усилия оживить её не привели к успеху, поэтому стажёру ничего не оставалось, кроме как двинуться дальше.&lt;br&gt;&#39;);
          fstClk = 0;
        } else { canPass = [0,0,0];  }
      } else
      {
        if ( fstClk != 0){
         document.getElementById(&#34;csafe&#34;).innerHTML = document.getElementById(&#34;csafe&#34;).innerHTML + decodeText(&#39;Лисицын нажал на кнопку с изображением &#39; + butdesc + &#39;, и панель пискнула, а в стене что-то щелкнуло&#39;);
         if ( fstClk &gt;1){
           document.getElementById(&#34;csafe&#34;).innerHTML = document.getElementById(&#34;csafe&#34;).innerHTML + decodeText(&#39; ещё раз&#39;);
         }
         document.getElementById(&#34;csafe&#34;).innerHTML = document.getElementById(&#34;csafe&#34;).innerHTML + &#39;.&lt;br&gt;&#39;;
        }
      }
 fstClk =  fstClk +1; 
   if (canPass[0]==1 &amp;&amp; canPass[1]==1 &amp;&amp; canPass[2]==1) {
       document.getElementById(&#34;csafe&#34;).innerHTML = document.getElementById(&#34;csafe&#34;).innerHTML + decodeText(&#39;Затем где-то впереди послышался громкий скрежет, и через мгновение изумлённый кадет увидел, как возле дальней лестницы часть стены отъехала вбок, открывая светящийся проход.&#39;);
       document.getElementById(&#34;safe&#34;).style.display = &#39;none&#39;; 
       step = 25;
       setTimeout( function(){document.getElementById(&#34;nextBtn&#34;).innerText = decodeText(&#39;расцепить слипшиеся страницы и перелистнуть&#39;);} , 100); 
   } 
}

function nextStep(){
     quest_id = -1;
     var quests =  new Array(0);
      
     if (nextStepVar != -1 ){
         step = nextStepVar; 
           nextStepVar = -1;    
         setTimeout( function(){document.getElementById(&#34;nextBtn&#34;).innerText = decodeText(&#39;расцепить слипшиеся страницы и перевернуть лист&#39;);} , 100);   
      }

     if (health &lt;=0){ health =0;}
     if (health &gt;9){ health = 9; }
     
     a_page = a_page + 1;
     document.getElementById(&#34;aPage&#34;).innerHTML = &#39;Страница № &#39; + a_page;
     
     var aFinisher = &#39;&#39;;
     if (prev_step&gt;0 &amp;&amp; step &lt;101){
        if (theTexts[12][prev_step] != &#39;&#39;){
             aFinisher = &#34;&lt;b&gt;Введение: &lt;/b&gt;&#34; +  decodeText(theTexts[12][prev_step]) + &#34;&lt;br&gt;&lt;br&gt;&#34;;
        }
     }

     if (prev_step == 13 || prev_step == 14) {
        allItems[9][0] = false;  
        allItems[10][0] = false;
     }

     if (prev_step == 15 || prev_step == 16) {
        allItems[2][1] = false;  
     } 
          

     //sum variants
     if (prev_step == 1 || prev_step == 2 || prev_step == 9 || prev_step == 10 || prev_step == 23 || prev_step == 24 ){
              sum_Q1.push(getSum(prev_qid)); monsterHealth = monsterHealth - sum_Q1[sum_Q1.length -1];
     }
     if (prev_step == 3 || prev_step == 4 || prev_step == 11 || prev_step == 12 || prev_step == 19 || prev_step == 20 ){
              sum_Q2.push(getSum(prev_qid));
     }
     if (prev_step == 5 || prev_step == 6 || prev_step == 13 || prev_step == 14 || prev_step == 17 || prev_step == 18 ){
              sum_Q3.push(getSum(prev_qid));  
     }
     if (prev_step == 7 || prev_step == 8 || prev_step == 15 || prev_step == 16 || prev_step == 21 || prev_step == 22 ){
          sum_Q4.push(getSum(prev_qid));
     }
     if (prev_step == 25 || prev_step == 26 || prev_step == 27 ){
              sum_Q5.push(getSum(prev_qid));
     }
     


     prev_step = step;

          document.getElementById(&#34;varsTab&#34;).style.display = &#39;block&#39;;

     isV1_clk = 0;
     isV2_clk = 0;

     //Find room quests
     for (i=0;  i&lt;theTexts[7].length; i++){
        if (theTexts[7][i][0] == step) {
           quests.push(i);
        }
     }

     //determine random encounter
     var encs = new Array(0);
     for (i=0; i &lt; theTexts[11].length; i++){
        if (theTexts[11][i][0] == step) {
         encs.push(i);
        }
     }     
     if (encs.length &gt; 0){
          enc_no = encs[Math.floor((Math.random() * encs.length) + 0)];
          theTexts[1][step]=theTexts[1][step].replace(/:renc_desc/gi, theTexts[11][enc_no][1]);
          theTexts[2][step]=theTexts[2][step].replace(/:renc_body/gi, theTexts[11][enc_no][2]);
           if (step == 9){
               theTexts[13][9][2]= theTexts[13][9][2].replace(/:renc_body/gi, theTexts[11][enc_no][2]);
           }

          //pic2 links
          theTexts[5][step][0]=theTexts[11][enc_no][3];
          theTexts[5][step][1]=theTexts[11][enc_no][4];
     }   
     
     //Choose random quest
     if (quests.length &gt; 0) {
       quest_id = quests[Math.floor((Math.random() * quests.length) + 1) - 1]; 
       document.getElementById(&#34;mainTxt&#34;).innerHTML = document.getElementById(&#34;mainTxt&#34;).innerHTML;
     }


       if ( step == 13 ||step == 14 ) {
           k = 0;
          for (i=0;i&lt;=5;i++){
               if(levers[i]==1){k++;}
          }  
         var dDesc;
         var dBut;
          if(k==6){
              didS2=true;
            dDesc = &#34;Все они сверкали золотистым светом&#34;;
              dBut = &#34;Лисицын нажал на кнопку, и перед его удивлённым взором часть стены отъехала вбок, явив его взору надпись: «Секретная остановка лифта активирована»&#34;;
           } else {
            dDesc = k + &#34; из них горели золотистым светом&#34;;
              dBut = &#34;Лисицын нажал на кнопку, но ничего не произошло&#34;;
          }

           

          var replA;
          if (allItems[8][0] == false){
                replA = theTexts[13][13][1];  
          } else {
                replA = theTexts[13][13][2];  
          } 
           replA = &#39;&lt;label style=&#34;cursor:text;&#34; onClick=&#34;id=\&#39;s2\&#39;; if(didS2==true){nextStepVar=26;document.getElementById(\&#39;nextBtn\&#39;).innerText =\&#39;разлепить слипшиеся страницы и перевернуть\&#39;;} allItems[8][0] = false; correctText(this,\&#39;стены, Лисицын притормозил на секунду, потому что что-то привлекло его взгляд. Приглядевшись, он увидел шесть диодов, наложенных на рисунок семиугольной звезды в шести её вершинах. &#39; + dDesc + &#39;. На месте седьмой вершины находилась небольшая серебристая кнопка. &#39; + dBut + &#39;\&#39; ,0,-1,-1);&#34;&gt;&#39; + replA+ &#39;&lt;/label&gt;&#39;;
                theTexts[2][step]=theTexts[2][step].replace(/:par13/gi, replA);  

      }


     params[9] = 0; document.getElementById(&#34;mainTxt&#34;).className = &#34;p&#34;;
     switch (step) {

          case 0:
             casualties = casualties + 11;  
             document.getElementById(&#34;enIntro&#34;).innerHTML = &#34;&#34;;
//             time_left = time_left - Math.floor((Math.random() * 3) + 1);             
             step = 0 + Math.floor((Math.random() * 2) + 1);   break;

          case 1:
             params[2] = 0;
             health = health - 1; 
             casualties = casualties + 5; allItems[1][0] = false;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 2 + Math.floor((Math.random() * 2) + 1);       break;

          case 2:
             params[1] = 0;
             casualties = casualties + 4;
             time_left = time_left - Math.floor((Math.random() * 3) + 2);       
             step = 2 + Math.floor((Math.random() * 2) + 1);           break;
             
          case 3:
             params[4] = 0;
             casualties = casualties + 12;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 4 + Math.floor((Math.random() * 2) + 1);             break;

          case 4:
             params[3] = 0;
             health = health - 1; 
             casualties = casualties + 6;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 4 + Math.floor((Math.random() * 2) + 1);             break;

          case 5:
             params[6] = 0; 
             casualties = casualties + 3;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 6 + Math.floor((Math.random() * 2) + 1);             break;
             
          case 6:
             params[5] = 0;
             casualties = casualties + 4;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 6 + Math.floor((Math.random() * 2) + 1);             break;     
             
          case 7:
             params[8] = 0;
             casualties = casualties + 1;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 8 + Math.floor((Math.random() * 2) + 1);             break;       

          case 8:
             params[7] = 0;
             health = health - 1; 
             casualties = casualties + 7;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 8 + Math.floor((Math.random() * 2) + 1);             break;

          case 9:
             params[10] = 0;
             health = health + 1; 
             casualties = casualties + 4;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 10 + Math.floor((Math.random() * 2) + 1);             break;
             
          case 10:
             params[9] = 0; document.getElementById(&#34;mainTxt&#34;).className = &#34;nonsel&#34;;
             time_left = time_left - Math.floor((Math.random() * 4) + 1);
             step = 10 + Math.floor((Math.random() * 2) + 1);             break;     
                                                      
          case 11:
             params[12] = 0;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 12 + Math.floor((Math.random() * 2) + 1);             break;

          case 12:
             params[11] = 0;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 12 + Math.floor((Math.random() * 2) + 1);             break;
             
          case 13:
             params[14] = 0;
             if(allItems[9][0] == true || allItems[10][0] == true){health = health - 1;} else {health = health - 2;}
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             casualties = casualties + 5; hasWatches = false;
             step = 14 + Math.floor((Math.random() * 2) + 1);             break;

          case 14:
             params[13] = 0;
             casualties = casualties + 4;
             if(allItems[9][0] == true || allItems[10][0] == true){health = health - 1;} else {health = health - 2;}
             params[14] = Math.floor((Math.random() * (theTexts[15].length - 1)) + 1);
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 14 + Math.floor((Math.random() * 2) + 1);             break;

          case 15:
             params[16] = 0;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 16 + Math.floor((Math.random() * 2) + 1);             break;
             
          case 16:
             params[15] = 0;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 16 + Math.floor((Math.random() * 2) + 1);             break;     
             
          case 17:
             params[18] = 0;
             casualties = casualties + 3;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 18 + Math.floor((Math.random() * 2) + 1);         break;       

          case 18:
             params[17] = 0;
             casualties = casualties + 4;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 18 + Math.floor((Math.random() * 2) + 1);            break;

          case 19:
             params[20] = 0;
             for (i=0;i&lt;=suspects[0].length-1;i++){
                if (suspects[0][i] != -2) {
                     theTexts[8][quest_id].push(&#39;&lt;img src=&#34;&#39; + suspects[2][i] + &#39;&#34; width = &#34;30&#34; height = &#34;30&#34;&gt; &#39;+ suspects[1][i]);
                     theTexts[8][quest_id].push(suspects[3][i]); 
                     theTexts[9][quest_id].push([suspects[0][i],0,suspects[0][i]*-1]); 

                }
             }
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 20 + Math.floor((Math.random() * 2) + 1);          break;
             
          case 20:
             params[19] = 0;
              for (i=0;i&lt;=suspects[0].length-1;i++){
                if (suspects[0][i] != -2) {
                     theTexts[8][quest_id].push(&#39;&lt;img src=&#34;&#39; + suspects[2][i] + &#39;&#34; width = &#34;30&#34; height = &#34;30&#34;&gt; &#39;+ suspects[1][i]);
                     theTexts[8][quest_id].push(suspects[3][i]); 
                     theTexts[9][quest_id].push([suspects[0][i],0,suspects[0][i]*-1]); 

                }
             }
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 20 + Math.floor((Math.random() * 2) + 1);            break;  
             
          case 21:
             params[22] = 0;
             casualties = casualties + 4;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 24;             break;

          case 22:
             params[21] = 0;
             health = health -1;
             casualties = casualties + 2;
             time_left = time_left - Math.floor((Math.random() * 3) + 1);

             step = 24;             break;
             
          case 23:  //There is no cow level
             params[24] = 0;
             time_left = time_left - Math.floor((Math.random() * 2) + 1);
             step = 100;             break;

          case 24:
             params[23] = 0;
             monsterHeath = monsterHealth - sum_Q1[0] - sum_Q1[1];
             if (sum_Q1[0] == 1 &amp;&amp; sum_Q1[1]==1){theTexts[1][step]=theTexts[1][step] + &#39; Монстр выглядел сильно потрёпанным за время, прошедшее с его побега. Видимо, ему довелось испытать много неприятностей на своём пути.&#39;;} else
             {if (sum_Q1[0] == 1 || sum_Q1[1]==1){theTexts[1][step]=theTexts[1][step] + &#39; Монстр не выглядел особо здоровым. Видимо, за время своего побега ему довелось испытать некоторые неприятности.&#39;;} else
             {theTexts[1][step]=theTexts[1][step] + &#39; Монстр выглядел абсолютно здоровым и жизнерадостным. Видимо, с момента его побега ничто не сумело доставить ему каких-либо неприятностей.&#39;;}             
             }
             time_left = time_left - Math.floor((Math.random() * 3) + 1);
             step = 100;             break;

          //Sec. rooms
          case 25:
             time_left = time_left + 5;
             allItems[25][1]=true;
             step = 6 + Math.floor((Math.random() * 2) + 1);             break;
             
          case 26:
             time_left = time_left + 5;       
             allItems[26][1]=true;   
             step = 14 + Math.floor((Math.random() * 2) + 1);             break;     
             
          case 27:
             allItems[27][1]=true;
             time_left = time_left + 5;          
             step = 24;             break;       
          
          case 100:
             finalTitles();              break;      
 
          case 101:
//            alert(&#39;reload&#39;);
            top.location.href=&#34;http://scpfoundation.ru/scp-0002-ru-s&#34;;   
            break;
                                
      } //switch

     if (prev_step &lt; 100) {

     
     
      //static variable params   
         


      
      if ( step == 5 ||step == 6 ) {

          if (allItems[3][1] == true){
                theTexts[2][step]=theTexts[2][step].replace(/:par05/gi, theTexts[13][5][1]); 
                theTexts[2][step]=theTexts[2][step].replace(/:par06/gi, theTexts[13][6][1]); 
          } else {
                theTexts[2][step]=theTexts[2][step].replace(/:par05/gi, theTexts[13][5][2]); 
                theTexts[2][step]=theTexts[2][step].replace(/:par06/gi, theTexts[13][6][2]); 
          }  

          var aTab = &#39;&lt;br&gt;&lt;label id=$csafe$&gt;&lt;/label&gt;&lt;div id = $safe$style=$float:center; margin: 10px; font-size: 50px;$ &gt;&lt;table  class=$wiki-content-table$&gt;&lt;tr&gt;&lt;td&gt;&lt;button id = $b01$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;☼&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b02$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;☂&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b03$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;☃&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b04$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;〜&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b05$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;☁&lt;/button&gt;&lt;/td&gt;&lt;/tr&gt;&#39;;

          if (params[1]!=0)  {
               aTab = aTab + &#39;&lt;tr&gt;&lt;td&gt;&lt;button id = $b11$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;N&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b12$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;S&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b13$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;W&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b14$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;E&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt; &#39;;
          } else {
              aTab = aTab + &#39;&lt;tr&gt;&lt;td&gt;&lt;button id = $b21$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer; color: #FF0000;$ &gt;■&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b22$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer; color: #0000FF;$ &gt;■&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b23$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer; color: #FFFF00;$ &gt;■&lt;/button&gt;&lt;/td&gt;           &lt;td&gt;&lt;button id = $b24$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer; color: #FF9900;$ &gt;■&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&#39;;
         }

          if (params[3]!=0)  {
               aTab = aTab + &#39;&lt;tr&gt;&lt;td&gt;&lt;button id = $b31$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;○&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b32$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;□&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b33$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;△&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&#39;;
          } else {
              aTab = aTab + &#39;&lt;tr&gt;&lt;td&gt;&lt;button id = $b41$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;♒&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b42$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;▓&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;button id = $b43$ type=$button$ onclick=$butClick(this)$  style=$cursor:pointer;$ &gt;♨&lt;/button&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&#39;;
         }
          aTab = aTab + &#39; &lt;/table&gt;      &lt;/div&gt;&#39;;
          theTexts[2][step]= theTexts[2][step].replace(/:code_panel/gi, aTab);
      }
       
 
      //renew suspects
      if ((step == 5 || step == 6 ||step == 7 || step == 8 ||step == 9 || step == 10 ||step == 13 || step == 14 ||step == 15 || step == 16 ) &amp;&amp; prev_step &lt;25) {
           k = Math.floor((Math.random() *10) + 0);

           while (suspects[0][k] != 0) {
               k = Math.floor((Math.random() *10) + 0);
           }
           lastSuspect = k;
           suspects[0][k] = -1;
           theTexts[2][step]= theTexts[2][step].replace(/:suspect_clue/gi,  suspects[4][k][Math.floor((Math.random() *2) + 0)]);
           if (step == 9){
               theTexts[13][9][2]= theTexts[13][9][2].replace(/:suspect_clue/gi,  suspects[4][k][Math.floor((Math.random() *2) + 0)]);
           }

      }
      if (prev_step &gt;=25) {
            k = lastSuspect;
           theTexts[2][step]= theTexts[2][step].replace(/:suspect_clue/gi,  suspects[4][k][Math.floor((Math.random() *2) + 0)]);
      }




          var curInv = &#34;Содержимое инвентаря субъекта: &lt;br&gt;&lt;br&gt;&#34;; 
          for (i=0;i&lt;allItems.length;i++) {
            if (allItems[i][0]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][4] + &#34;&#39; title = &#39;&#34; + allItems[i][2] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
            if (allItems[i][1]== true) {curInv = curInv + &#34;&lt;img src=&#39;&#34; + allItems[i][5] + &#34;&#39; title = &#39;&#34; + allItems[i][3] + &#34;&#39; height=&#39;30&#39; width=&#39;30&#39;&gt;&#34; + &#34;, &#34;;}
          }
          curInv = curInv.slice(0, curInv.length - 2);         
          document.getElementById(&#34;pInv&#34;).innerHTML =  decodeText(curInv);
         
          var re = new RegExp(theTexts[15][0],&#34;gi&#34;);

          //nochange for medbay 
          if (prev_step == 14) {  
               document.getElementById(&#34;aHead&#34;).innerHTML= aFinisher + &#34;&lt;b&gt;Место действия: &lt;/b&gt;&#34; + decodeText(theTexts[0][prev_step]).replace(re,theTexts[15][params[14]]);

          } else {
               document.getElementById(&#34;aHead&#34;).innerHTML= aFinisher.replace(re,theTexts[15][params[14]]) + &#34;&lt;b&gt;Место действия: &lt;/b&gt;&#34; + decodeText(theTexts[0][prev_step]).replace(re,theTexts[15][params[14]]);
          }

          document.getElementById(&#34;mainTxt&#34;).innerHTML= &#34;&lt;b&gt;Описание локации: &lt;/b&gt;&#34; + decodeText(theTexts[1][prev_step]).replace(re,theTexts[15][params[14]]) + 
                                                &#34;&lt;br&gt;&lt;br&gt;&lt;b&gt;Последовательность событий: &lt;/b&gt;&#34; + decodeText(theTexts[2][prev_step]).replace(re,theTexts[15][params[14]]);
          document.getElementById(&#34;pic1t&#34;).innerHTML= decodeText(theTexts[4][prev_step][0]);
          document.getElementById(&#34;pic2t&#34;).innerHTML= decodeText(theTexts[5][prev_step][0]);
          document.getElementById(&#34;pic1&#34;).src= theTexts[4][prev_step][1];
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][prev_step][1];
          if(prev_step==24){               document.getElementById(&#34;pic2&#34;).src= theTexts[5][prev_step][1] + monsterHealth + &#39;.png&#39;;}
          document.getElementById(&#34;tHead&#34;).innerHTML= decodeText(theTexts[6][prev_step]);
     }
    
     if (allItems[25][0] == true) {

          document.getElementById(&#34;pHead&#34;).innerHTML=document.getElementById(&#34;pHead&#34;).innerHTML + &#39;&lt;br&gt;Зарегистрированные загубленные души: &#39; + casualties + &#39; шт.&#39;;
 
     }     

      if (quests.length &gt; 0) {

          tConstruct(); 

           if (prev_step == 10){
                       document.getElementById(&#34;tContainer&#34;).style.color = &#34;#E0E0D1&#34;;
                       document.getElementById(&#34;tHead&#34;).style.color = &#34;#E0E0D1&#34;;
                       
                       if (allItems[3][0] == false){     
                                    document.getElementById(&#34;mainTxt&#34;).innerHTML =document.getElementById(&#34;mainTxt&#34;).innerHTML.replace(/:par11/gi, decodeText(theTexts[13][11][1]));  
                       } else {
                                    document.getElementById(&#34;mainTxt&#34;).innerHTML =document.getElementById(&#34;mainTxt&#34;).innerHTML.replace(/:par11/gi, decodeText(theTexts[13][11][2])); 
                           allItems[3][0] = false;
                           removeVar(allItems[3][2]);
                       }   
             
           } else {
                       document.getElementById(&#34;tContainer&#34;).style.color = &#34;#000000&#34;;
                       document.getElementById(&#34;tHead&#34;).style.color = &#34;#000000&#34;;
           }
      } else
      {
          document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
          document.getElementById(&#34;nextBtn&#34;).disabled = false;
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;

      }

     if (health &lt;=0){ health = 0; }
     if (health &gt;=9){ health = 9; } 


     if (step &lt; 101) {
 
             document.getElementById(&#34;pHead&#34;).innerHTML= decodeText(theTexts[3][prev_step])+ &#34;&lt;br&gt; Самочувствие субъекта: &#34; + decodeText(theTexts[14][health]); //refresh timer
 
             if (allItems[25][0] == true) {

                        document.getElementById(&#34;pHead&#34;).innerHTML=document.getElementById(&#34;pHead&#34;).innerHTML + &#39;&lt;br&gt;Зарегистрированные загубленные души: &#39; + casualties + &#39; шт.&#39;;
 
              }     
             setTimeout( function(){document.getElementById(&#34;nextBtn&#34;).innerText = decodeText(theTexts[10][prev_step]);} , 100); 

      } else {
             setTimeout( function(){document.getElementById(&#34;nextBtn&#34;).innerText = decodeText(theTexts[10][theTexts[10].length - 1]);} , 100);  
      }

      prev_qid = quest_id;

      //personal hideout
      if (prev_step ==9) {
          document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
          document.getElementById(&#34;nextBtn&#34;).disabled = false;
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;
       }
     if (quest_id&gt;-1){
        if (theTexts[8][quest_id][0] ==&#39;button&#39;) {
             document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
             document.getElementById(&#34;nextBtn&#34;).disabled = false;
        } 
     }     

    if (time_left&lt;=0) {
       if (allItems[13][1]==true) {
                    document.getElementById(&#34;aHead&#34;).innerHTML= &#39;&lt;br&gt;&lt;br&gt;&#39; + &#39;Время, которое стажёр отмерял для жизни реактора, подошло к концу, но вместо взрыва он услышал тоненький писк из своего правого кармана. Это сработал &#39; + allItems[13][3] + &#39; который, похоже, изменил пространственно-временной континуум, добавив к таймеру еще 7 минут&#39;;
          time_left = time_left + 7;
       } else {
        finalTitles();  
       }
    }
}

function finalTitles() {

    var s_result =theTexts[13][26][4];
    var s_status =&#39;наградить героя в присутствии всех оставшихся в строю участников событий&#39;;
    var mission_perc;
    var dmg_clss;
    var obj_class = 0;
    var q2_res=0;
          if  (sum_Q2[2]==1){ q2_res = 1;}

    if (allItems[25][1] == true){obj_class = obj_class +1;}
    if (allItems[26][1] == true){obj_class = obj_class +1;}
    if (allItems[27][1] == true){obj_class = obj_class +1;}

          //Final screen
          document.getElementById(&#34;fightField&#34;).style.display = &#39;none&#39;;
          document.getElementById(&#34;nextBtn&#34;).style.color = &#39;black&#39;;
          document.getElementById(&#34;nextBtn&#34;).disabled = false;
          document.getElementById(&#34;varsTab&#34;).style.display = &#39;none&#39;;



      if (time_left&lt;=0){ 
          s_status = decodeText(theTexts[13][26][1]);
          s_result =  decodeText(theTexts[13][26][2]); ;  

          theTexts[1][28]= theTexts[1][28].replace(/:p0/gi,   s_status);
          theTexts[1][28]= theTexts[1][28].replace(/:p1/gi,   s_result);

          document.getElementById(&#34;aHead&#34;).innerHTML= decodeText(theTexts[0][28] + theTexts[1][28]);

          document.getElementById(&#34;mainTxt&#34;).innerHTML= &#34;&lt;font color = &#39;red&#39;&gt;&lt;b&gt;Взрыв реактора оборвал жизнь кадета и стёр лабораторию нестандартных испытаний с лица земли!&lt;/b&gt;&lt;/font&gt;&#34;;
          document.getElementById(&#34;pHead&#34;).innerHTML= decodeText(theTexts[3][28]);
          document.getElementById(&#34;pic1t&#34;).innerHTML= decodeText(theTexts[4][28][0]);
          document.getElementById(&#34;pic2t&#34;).innerHTML= decodeText(theTexts[5][28][0]);
          document.getElementById(&#34;pic1&#34;).src= theTexts[4][28][1];
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][28][1];

          setTimeout( function(){document.getElementById(&#34;nextBtn&#34;).innerText = decodeText(theTexts[10][theTexts[10].length - 1]);} , 100);  

      }  else {
 
        if (params[26]==1){ 
            s_status = decodeText(theTexts[13][26][1]);
 
            s_result = decodeText(theTexts[13][26][3]);    

            if (params[27]==1){ 
                s_result =s_result + decodeText(theTexts[13][26][5]);         
            }  
        }  
     


          mission_perc =  parseInt(sum_Q1[0])*1 +  parseInt(sum_Q1[1])*1 +  parseInt(sum_Q2[0])*1 +  parseInt(sum_Q2[1])*1;

          theTexts[1][28]= theTexts[1][28].replace(/:p0/gi,   s_status);
          theTexts[1][28]= theTexts[1][28].replace(/:p1/gi,   s_result);
          

          theTexts[2][28]= theTexts[2][28].replace(/:p2/gi,  &#39;&lt;b&gt;&#39;+ theTexts[13][27][mission_perc] + &#39;&lt;/b&gt;&#39;);
          theTexts[2][28]= theTexts[2][28].replace(/:p3/gi,  &#39;&lt;b&gt;&#39;+ theTexts[13][28][mission_perc] + &#39;&lt;/b&gt;&#39;);


          mission_perc =  parseInt(sum_Q3[0])*1 +  parseInt(sum_Q3[1])*1 +  parseInt(sum_Q3[2])*1;

          theTexts[2][28]= theTexts[2][28].replace(/:p4/gi,  &#39;&lt;b&gt;&#39;+ mission_perc + &#39;&lt;/b&gt;&#39;);

          var vacc_lev = Math.floor(mission_perc/20);
          if (vacc_lev &lt;0){vacc_lev = 0;}

          theTexts[2][28]= theTexts[2][28].replace(/:p5/gi,  &#39;&lt;b&gt;&#39;+ vacc_lev + &#39;&lt;/b&gt;&#39;);


          theTexts[2][28]= theTexts[2][28].replace(/:p6/gi,  theTexts[13][28][6+ q2_res]  );

          theTexts[2][28]= theTexts[2][28].replace(/:p7/gi,  &#39;&lt;b&gt;&#39;+ casualties + &#39;&lt;/b&gt;&#39;);

         
          mission_perc = Math.floor(casualties/13);    if (mission_perc &gt;4){mission_perc = 4;}   

          theTexts[2][28]= theTexts[2][28].replace(/:p8/gi,  &#39;&lt;b&gt;&#39;+ theTexts[13][29][mission_perc]  + &#39;&lt;/b&gt;&#39;);
          theTexts[2][28]= theTexts[2][28].replace(/:p9/gi,  &#39;&lt;b&gt;&#39;+ theTexts[13][30][obj_class]  + &#39;&lt;/b&gt;&#39;);

          if(sum_Q4[0] ==1 || sum_Q4[0] == 3 ){
             if(sum_Q4[1] ==1 || sum_Q4[1] ==3 ){
                  if(sum_Q4[2] ==1 || sum_Q4[2] ==3 ){
                         dmg_clss =1;
                  } else{
                         dmg_clss =2;
                  } 
             } else{
                  if(sum_Q4[2] ==1 || sum_Q4[2] ==3 ){
                         dmg_clss =3;
                  } else{
                         dmg_clss =4;
                  } 
             } 
          }else{
             if(sum_Q4[1] ==1 || sum_Q4[1] ==3 ){
                  if(sum_Q4[2] ==1 || sum_Q4[2] ==3 ){
                         dmg_clss =5;
                  } else{
                         dmg_clss =6;
                  } 
             } else{
                  if(sum_Q4[2] ==1 || sum_Q4[2] ==3 ){
                         dmg_clss =7;
                  } else{
                         dmg_clss =8;
                  } 
             } 

          }

          theTexts[2][28]= theTexts[2][28].replace(/:p10/gi,   theTexts[13][31][dmg_clss-1] );

          //summary -1prc for death
          mission_perc = (4-mission_perc )*25 + ( parseInt(sum_Q1[0])*1 +  parseInt(sum_Q1[1])*1 +  parseInt(sum_Q2[0])*1 +  parseInt(sum_Q2[1])*1) * 20 + ( q2_res )*100 + ( parseInt(sum_Q3[0])*1 +  parseInt(sum_Q3[1])*1 +  parseInt(sum_Q3[2])*1) + (100 - (dmg_clss - 1) * (100/7)) + ( obj_class*33 ); 
 
          mission_perc = Math.floor((mission_perc+ 1-params[26])/5);
 
          theTexts[2][28]= theTexts[2][28].replace(/:p11/gi,   mission_perc);

          if( mission_perc &lt; 50 ) {
             theTexts[2][28]= theTexts[2][28].replace(/:p12/gi,  &#39;&lt;span style=&#34;background-color:#FF0000&#34;&gt;ОТКАЗАТЬ&lt;/span&gt; ЕМУ ВО ВСТУПЛЕНИИ&#39; );          
             if (params[26]==1){ theTexts[2][28]= theTexts[2][28].replace(/:p13/gi, &#39; и не выплачивать компенсации на похороны.&#39;);} else {theTexts[2][28]= theTexts[2][28].replace(/:p13/gi, &#39;.&#39;);}
          } else {
             theTexts[2][28]= theTexts[2][28].replace(/:p12/gi,  &#39;&lt;span style=&#34;background-color:#00FF00&#34;&gt;ПРИНЯТЬ&lt;/span&gt; ЕГО&#39; );          
             if (params[26]==1){ theTexts[2][28]= theTexts[2][28].replace(/:p13/gi, &#39;, похоронив со всеми полагающимися почестями.&#39;);} else {theTexts[2][28]= theTexts[2][28].replace(/:p13/gi, &#39; и устроить по этому поводу банкет.&#39;);}
          }

          if( mission_perc &gt;=100 ) {
                theTexts[2][28]= theTexts[2][28] + &#39;&lt;br&gt;&lt;br&gt; Имя кадета Лисицына отныне вписывается в золотую историю Фонда, и сам он получает звание человека, &lt;span style=&#34;background-color:#00FF00&#34;&gt;В СОВЕРШЕНСТВЕ&lt;/span&gt; выполнившего выпавшие на его долю Практические Занятия&#39;;
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][29][1];
          }

          theTexts[2][28]= theTexts[2][28].replace(/:p14/gi,   roomRed[0]);

          var repNo = &#39;SCPR0&#39; + roomRed[1] + &#39;S1&#39; + roomRed[2]+ &#39;F2&#39; + roomRed[3]+ &#39;G3&#39; + roomRed[4]+ &#39;J4&#39; + roomRed[5]+ &#39;K5&#39; + roomRed[6]+ &#39;V6&#39; + roomRed[7]+ &#39;B7&#39; + roomRed[8]+ &#39;Y8&#39; + roomRed[9]+ &#39;M9&#39; + roomRed[10]+ &#39;W10&#39; + roomRed[11]+ &#39;T11&#39; + roomRed[12]+ &#39;P12&#39; + roomRed[13]+ &#39;O13&#39; + roomRed[14]+ &#39;C14&#39; + roomRed[15]+ &#39;G15&#39; + roomRed[16]+ &#39;T16&#39; + roomRed[17]+ &#39;X17&#39; + roomRed[18]+ &#39;Z18&#39; + roomRed[19]+ &#39;M19&#39; + roomRed[20]+ &#39;H20&#39; + roomRed[21]+ &#39;L21&#39; + roomRed[22]+ &#39;D22&#39; + roomRed[23]+ &#39;N23&#39; + roomRed[24]+ &#39;E24&#39; + roomRed[25]+ &#39;Q25&#39; + roomRed[26]+ &#39;I26&#39; + roomRed[27] + &#39;RU&#39;;

          theTexts[2][28]= theTexts[2][28].replace(/:p15/gi,  repNo);


          var re = new RegExp(theTexts[15][0],&#34;gi&#34;);
             theTexts[0][28]=theTexts[0][28].replace(re,theTexts[15][params[14]]);
             theTexts[1][28]=theTexts[1][28].replace(re,theTexts[15][params[14]]);
             theTexts[2][28]=theTexts[2][28].replace(re,theTexts[15][params[14]]);


          document.getElementById(&#34;aHead&#34;).innerHTML= decodeText(theTexts[0][28]+ theTexts[1][28]);
          document.getElementById(&#34;mainTxt&#34;).innerHTML= decodeText(theTexts[2][28]);
          document.getElementById(&#34;pHead&#34;).innerHTML= decodeText(theTexts[3][28]);
          document.getElementById(&#34;pic1t&#34;).innerHTML= decodeText(theTexts[4][28][0]);
          document.getElementById(&#34;pic2t&#34;).innerHTML= decodeText(theTexts[5][28][0]);
          document.getElementById(&#34;pic1&#34;).src= theTexts[4][28][1];
          document.getElementById(&#34;pic2&#34;).src= theTexts[5][28][1];

         }
          step = 101;
     
}


//Story start 


nextStep();
 


&lt;/script&gt;
[[/html]]</textarea></pre>
  </div>

</div>

<div id="footer">
  
    <em>Last updated 2024-02-07 18:30:35.515669.</em>
  
</div>
</body>